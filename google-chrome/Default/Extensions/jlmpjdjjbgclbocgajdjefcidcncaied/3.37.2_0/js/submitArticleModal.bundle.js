"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[5646],{69333:(e,t,l)=>{l.r(t),l.d(t,{default:()=>B});var n,i,a=l(7527),o=l(89338),s=l(75087),r=l(2827),u=l.n(r),c=l(22155),m=l(69918),d=l(14243),p=l(5947),v=l(53823),f=l(83448),b=l(17398),y=l(54883),h=l(43660),g=l(80244),x=l(91591),A=l(2972),k=(0,A.gql)(n||(n=(0,x.A)(["\n  mutation SubmitArticle($url: String!) {\n    submitArticle(url: $url) {\n      result\n      reason\n      post {\n        id\n        title\n        commentsPermalink\n        image\n        readTime\n        numUpvotes\n        permalink\n        source {\n          id\n          image\n        }\n      }\n      submission {\n        id\n        url\n        userId\n        createdAt\n        status\n        reason\n      }\n    }\n  }\n"]))),S=(0,A.gql)(i||(i=(0,x.A)(["\n  query SubmissionAvailability {\n    submissionAvailability {\n      hasAccess\n      limit\n      todaySubmissionsCount\n    }\n  }\n"]))),w=l(27601),N=l(61663),C=l(26540),F=l(14431),T=l(75289),U=l(94198),_=l(53338),q=l(57952),D=l(16714),P=l(14647),j=l(68392),R=l(36899),z=["onRequestClose"],E=c.createElement,I="Something went wrong, try again",$="Community picks";function B(e){var t,l,n=e.onRequestClose,i=(0,s.A)(e,z),r=(0,c.useRef)(),x=(0,c.useContext)(g.Ay).user,A=(0,m.jE)(),B=(0,c.useContext)(N.Ay).logEvent,L=(0,j.mu)().displayToast,M=(0,c.useState)(!1),H=M[0],O=M[1],V=(0,c.useState)(!1),J=V[0],K=V[1],X=(0,c.useState)(null),Y=X[0],Z=X[1],G=(0,c.useState)(),Q=G[0],W=G[1],ee=["submission_availability",null==x?void 0:x.id],te=(0,d.I)({queryKey:ee,queryFn:function(){return R.e.request(S)}}),le=te.data,ne=te.isFetched,ie=(le||{}).submissionAvailability,ae=null!==(t=null==ie?void 0:ie.limit)&&void 0!==t?t:3,oe=null==ie?void 0:ie.hasAccess,se=(0,p.n)({mutationFn:function(e){return R.e.request(k,{url:e})}}).mutateAsync,re=function(e){B({event_name:"submit article fail",extra:JSON.stringify({reason:e})})},ue=function(){var e=(0,o.A)(u().mark((function e(t){var l,i,a,o,s,r,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),l=(0,b.Y)(t.currentTarget),K(!0),l.articleUrl){e.next=7;break}return W("Please submit a valid URL"),K(!1),e.abrupt("return");case 7:return B({event_name:"submit article",feed_item_title:"Submit article",extra:JSON.stringify({url:null==l?void 0:l.articleUrl})}),e.prev=8,e.next=11,se(l.articleUrl);case 11:i=e.sent,a=i.submitArticle,o=a.reason,s=void 0===o?I:o,r=a.post,a.submission?((c={submissionAvailability:ie}).submissionAvailability.todaySubmissionsCount+=1,A.setQueryData(ee,c),B({event_name:"submit article succeed"}),L("We will notify you about the post-submission status via email"),n(null)):r?(Z({post:r}),re("Article exists already")):s&&(W(s),re(s)),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(8),W(I),O(!1),re(I);case 21:return e.prev=21,K(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[8,16,21,24]])})));return function(t){return e.apply(this,arguments)}}();if((0,c.useEffect)((function(){B({event_name:q.VB.StartSubmitArticle,feed_item_title:q.IT.SubmitArticle,extra:JSON.stringify({has_access:!(null==x||!x.canSubmitArticle)})})}),[]),!ne)return E(c.Fragment,null);var ce={"aria-label":"Submit",loading:J,disabled:!H||!oe||!!Y};return E(U.aF,(0,a.A)({},i,{kind:U.aF.Kind.FlexibleTop,size:U.aF.Size.Medium,onRequestClose:n,formProps:{form:"submit-article",title:$,rightButtonProps:ce}}),E(U.aF.Header,{title:$}),E(U.aF.Body,null,E("form",{ref:r,id:"submit-article","aria-busy":J,onSubmit:ue,className:"flex flex-col gap-5"},E("div",{className:"flex flex-col gap-4"},E("p",{className:"text-text-tertiary typo-callout"},"Found an interesting post? Do you want to share it with the community? Enter the post's URL / link below to add it to the feed."),E("a",{className:"font-bold text-text-link underline typo-callout",target:"_blank",rel:"noopener",href:y.GA},"Learn more")),E("p",{className:"typo-callout"},"Daily suggestions usedÂ ",null!==(l=null==ie?void 0:ie.todaySubmissionsCount)&&void 0!==l?l:0,"/",ae),E(h.A,{autoFocus:!0,type:"url",autoComplete:"off",leftIcon:E(C.q,null),rightIcon:oe?void 0:E(F.X,{className:"text-text-disabled"}),fieldType:"tertiary",name:"articleUrl",inputId:"article_url",label:"Post url",disabled:!oe,hint:Q,valid:!Q,valueChanged:function(){r.current&&(Y&&Z(null),Q&&W(null),O(r.current.checkValidity()))}}),(null==ie?void 0:ie.todaySubmissionsCount)===ae&&E(T.Ay,{type:T.vT.Error,title:"You have reached the limit of ".concat(ae," submissions per day")}),oe&&E(_.A,{source:q.vH.CommunityPicks}),Y?null:oe?E(T.Ay,{className:"mt-4",title:"Submission guidelines"},E(T.Bs,null,"We want you to submit links that are well thought out, high value and high quality."),E(T.Bs,null,"Please do not add your own posts, promotional content, clickbait etc. Additionally, redirected or shortened URLs will be rejected, please submit the full and final URL."),E(T.Bs,null,"For more details see our"," ",E("a",{className:"text-text-link hover:underline",href:y.fX,target:"_blank",rel:"noopener"},"content guidelines"))):E(P.e,null))),Y&&E("div",{className:"w-full"},E("h4",{className:"mb-2 pl-6 font-bold typo-callout"},"Article exists"),E(w.A,{postItem:Y,showButtons:!1})),E(U.aF.Footer,{justify:D.F1.End},E(v.$n,(0,a.A)({},ce,{variant:f.Ak.Primary,type:"submit",form:"submit-article",loading:J}),"Submit")))}},27601:(e,t,l)=>{l.d(t,{A:()=>_});var n=l(22155),i=l(30395),a=l.n(i),o=l(95974),s=l(55059),r=l(88193),u=l(74921),c=l(67371),m=l(60471),d=l(63423),p=l(7986),v=l(38638),f=l(41536),b=l(27504),y=l(16763),h=l(69918),g=l(80244),x=l(30530),A=l(90087),k=l(34091),S=function(){var e=(0,h.jE)(),t=(0,n.useContext)(g.Ay).user;return(0,A.o)({variables:{key:x.jZ.ReadingHistory},onMutate:function(l){var n=l.id,i=l.vote,a=e.getQueryData((0,x.$h)(x.jZ.ReadingHistory,t));return(0,k.p)({id:n,vote:i,data:a,user:t,queryClient:e})}})},w=l(57952),N=l(53823),C=l(83448),F=l(19505),T=n.createElement,U=(0,d.A)("div","absolute left-5 -my-1 w-8 h-8 rounded-full bg-background-default");function _(e){var t,l,i,d,h,g=e.postItem,x=e.showButtons,A=void 0===x||x,k=e.clickable,_=void 0===k||k,q=e.onHide,D=e.className,P=e.onContextMenu,j=e.showVoteActions,R=void 0!==j&&j,z=e.logOrigin,E=void 0===z?w.$e.Feed:z,I=g.timestampDb,$=g.post,B=null!==(t=null==$?void 0:$.sharedPost)&&void 0!==t?t:$,L=S(),M=L.toggleUpvote,H=L.toggleDownvote,O=a()("relative flex w-full flex-row py-3 pl-9 pr-5",R?"items-start tablet:items-center":"items-center",_&&"hover:cursor-pointer hover:bg-surface-hover",D);return T("article",{className:a()(!_&&O)},T(b.A,{condition:_,wrapper:function(e){return T(o.A,{href:$.commentsPermalink},T("a",{className:O,title:"Go to post"},e))}},T(n.Fragment,null,T(f._V,{src:B.image,alt:$.title,className:"h-16 w-16 rounded-16 object-cover laptop:w-24",loading:"lazy",fallbackSrc:y.uC}),T(U,{className:R&&"top-8"}),T(v.Y3,{size:v.Ov.Small,rounded:"full",className:a()("absolute left-6",R&&"top-8"),user:{image:$.source.image,username:"source of ".concat($.title)},nativeLazyLoading:!0}),T("div",{className:a()("flex flex-1",R?"flex-col tablet:flex-row":"items-center")},T("div",{className:"ml-4 flex flex-1 flex-col"},T("h3",{className:"mr-6 line-clamp-2 flex flex-1 break-words text-left typo-callout"},$.title),T(p.A,{readTime:$.readTime,numUpvotes:$.numUpvotes,isVideoType:(0,s.CX)($)})),T("div",{className:"ml-4 mt-1 flex tablet:ml-0 tablet:mt-1"},A&&R&&T(n.Fragment,null,T(N.$n,{size:C.Mp.Small,variant:C.Ak.Tertiary,color:R?F.h.Avocado:void 0,className:R?"flex":"hidden laptop:flex",pressed:(null==$||null===(l=$.userState)||void 0===l?void 0:l.vote)===s.mj.Up,onClick:function(e){e.preventDefault(),M({payload:$,origin:E})},icon:T(r.l,{secondary:(null==$||null===(i=$.userState)||void 0===i?void 0:i.vote)===s.mj.Up})}),T(N.$n,{size:C.Mp.Small,variant:C.Ak.Tertiary,color:R?F.h.Ketchup:void 0,className:R?"flex":"hidden laptop:flex",pressed:(null==$||null===(d=$.userState)||void 0===d?void 0:d.vote)===s.mj.Down,onClick:function(e){e.preventDefault(),H({payload:$,origin:E})},icon:T(u.y,{secondary:(null==$||null===(h=$.userState)||void 0===h?void 0:h.vote)===s.mj.Down})})),A&&!R&&q&&T(N.$n,{size:C.Mp.Small,variant:C.Ak.Tertiary,className:"hidden laptop:flex",icon:T(c.d,null),onClick:function(e){e.stopPropagation(),e.preventDefault(),q({postId:$.id,timestamp:I})}}),A&&T(N.$n,{variant:C.Ak.Tertiary,"data-testid":"post-item-".concat($.id),icon:T(m.Z,null),onClick:function(e){e.stopPropagation(),e.preventDefault(),P(e,g)},size:C.Mp.Small}))))))}}}]);