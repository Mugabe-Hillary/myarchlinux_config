(self.webpackChunkextension=self.webpackChunkextension||[]).push([[9706],{75653:(e,t,r)=>{"use strict";r.d(t,{T:()=>h});var n=r(22155),a=r(30395),o=r.n(a),l=r(96888),i=r(59904),c=r(53823),u=r(83448),s=r(95974),d=r(54883),p=r(76800),v=r(80244),f=r(81602),m=r(57952),y=r(61663),g=r(77955),b=r(13713),C=n.createElement,h=function(e){var t,r=e.className,a=e.onPlusClick,h=e.hideBuyButton,k=(0,b.f1)(),w=null!==(0,g.k3)().onRequestClose,P=(0,v.Z2)().user,O=!h,A=(0,y.DX)().logEvent;return k?C("div",{className:o()("flex items-center rounded-10 bg-surface-float",r)},C(s.A,{href:d.JY,passHref:!0},C(c.$n,{tag:"a",target:w?"_blank":void 0,rel:p.O8,variant:u.Ak.Tertiary,icon:C(l.t,null),size:u.Mp.Small},(0,f.Kt)((null==P||null===(t=P.balance)||void 0===t?void 0:t.amount)||0))),O?C(n.Fragment,null,C("div",{className:"h-[1.375rem] w-px bg-border-subtlest-tertiary"}),C(c.$n,{variant:u.Ak.Tertiary,icon:C(i.c,null),size:u.Mp.Small,onClick:function(){A({event_name:m.VB.StartBuyingCredits,extra:JSON.stringify({origin:m.$e.Award})}),null==a||a()}})):null):null}},18857:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>nt});var n=r(11999),a=r(7527),o=r(50122),l=r(89338),i=r(2827),c=r.n(i),u=r(22155),s=r(30395),d=r.n(s),p=r(14243),v=r(5947),f=r(94198),m=r(67380),y=r(53823),g=r(83448),b=r(96888),C=r(13879),h=r(41536),k=r(16763),w=r(9487),P=r(61663),O=r(11924),A=r(57952),S=r(68390),E=r(54883),N=r(70591),R=r(95092),x=u.createElement;function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I="INTRO",F="AWARD",_={USER:{START:A.VB.StartAwardUser,PICK:A.VB.PickAwardUser,AWARD:A.VB.AwardUser},POST:{START:A.VB.StartAwardPost,PICK:A.VB.PickAwardPost,AWARD:A.VB.AwardPost},COMMENT:{START:A.VB.StartAwardComment,PICK:A.VB.PickAwardComment,AWARD:A.VB.AwardComment}},D=u.createContext(void 0);var M=function(e){var t=e.children,r=e.onRequestClose,n=e.type,a=e.entity,o=e.post,l=(0,w.useRouter)(),i=(0,P.DX)().logEvent,c=(0,u.useState)({screen:I}),s=c[0],d=c[1],p=(0,u.useState)(F),v=p[0],f=p[1],m=(0,R.Qf)(["(prefers-reduced-motion)"],[!0],!1,!1),y=(0,u.useCallback)((function(e){var t,r=e.awardEvent,a=e.extra,l=null===(t=_[n])||void 0===t?void 0:t[r];i("USER"===n?{event_name:l,extra:JSON.stringify(j({},a))}:(0,O.P5)(l,o,{extra:a}))}),[i,o,n]),g=(0,u.useMemo)((function(){return{activeModal:v,setActiveModal:function(e){if("BUY_CORES"===e&&(0,S.oX)()){var t=new URLSearchParams({origin:A.$e.Award});return null!=o&&o.id&&t.append("next","/posts/".concat(o.id)),void(null==l||l.replace((0,N.Lz)("".concat(E.ZO,"cores"),t)))}f(e)},onRequestClose:function(e){!m&&"SUCCESS"===s.screen&&s.product?f("AWARD_ANIMATION"):null==r||r(e)},activeStep:s.screen,product:s.product,setActiveStep:d,type:n,entity:a,logAwardEvent:y,post:o}}),[v,r,s.screen,s.product,n,a,y,l,o,m]);return x(D.Provider,{value:g},t)},B=function(){return(0,u.useContext)(D)},X=r(16714),U=r(24481),L=r(72870),q=r(68392),V=r(77955),$=r(97838),z=r(75653),K=r(75087),G=r(69918),W=r(38166),Z=r.n(W),H=r(89113),Y=r(37567),J=r(7941),Q=r(83362),ee=r(89334),te=u.createElement,re="INTRO",ne="PROCESSING",ae=u.createContext(void 0);var oe=function(e){var t=e.onCompletion,r=e.origin,n=e.amountNeeded,a=e.children,o=(0,P.DX)().logEvent,l=(0,u.useState)({step:re}),i=l[0],c=l[1],s=(0,u.useState)(),d=s[0],p=s[1];(0,u.useRef)().current=o;var v=(0,J.t)({type:Q.Ey.Cores}).data,f=function(e){var t=e.priceId;return(0,Y.WP)({priceId:t,prices:v})},m=(0,u.useRef)(f);m.current=f;var y=(0,ee.W)({successCallback:function(e){c({step:ne,providerTransactionId:e.data.transaction_id})},getProductQuantity:function(e){var t;return m.current({priceId:null===(t=e.data.items[0])||void 0===t?void 0:t.price_id})},targetType:A.yK.Credits}),g=y.paddle,b=y.openCheckout,C=(0,u.useMemo)((function(){return{paddle:g,amountNeeded:n,onCompletion:t,activeStep:i.step,error:i.error,setActiveStep:c,selectedProduct:d,setSelectedProduct:p,openCheckout:b,providerTransactionId:i.providerTransactionId,origin:r}}),[i,n,t,b,r,g,d]);return te(ae.Provider,{value:C},a)},le=function(){return(0,u.useContext)(ae)},ie=u.createElement,ce=function(e){var t=e.id,r=e.priceFormatted,n=e.cores,a=e.label,o=(0,L.G6)(L.bh.MobileL),l=(0,P.DX)().logEvent,i=le(),c=i.selectedProduct,s=i.setSelectedProduct,p=i.openCheckout,v=i.origin,f=i.paddle,b=(0,u.useCallback)((function(){l({event_name:A.VB.SelectCreditsQuantity,extra:JSON.stringify({origin:v,quantity:null==c?void 0:c.value})}),s({id:t,value:n}),o||p({priceId:t})}),[l,v,t,s,n,o,p,c]);return ie(y.$n,{className:d()("w-full",(null==c?void 0:c.id)===t?"border-action-cores-default bg-action-cores-float":void 0),variant:g.Ak.Float,icon:ie(h._V,{className:"mr-2 size-8",src:(0,k.qQ)(n),fallbackSrc:k.dX}),size:g.Mp.Large,"aria-checked":(null==c?void 0:c.id)===t,role:"radio",onClick:b,disabled:!f},ie(m.o5,{type:m.kR.Body,color:m.X8.Primary,bold:!0},a),ie("div",{className:"flex-1"}),ie(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"font-normal"},r))},ue=function(){return ie(y.$n,{className:"w-full",variant:g.Ak.Float,size:g.Mp.Large,disabled:!0},ie(m.o5,{type:m.kR.Body,color:m.X8.Primary,bold:!0}))},se=u.createElement,de=function(){var e=(0,J.t)({type:Q.Ey.Cores}),t=e.data,r=e.isPending;return se("ul",{className:"mt-4 flex flex-col gap-2",role:"radiogroup"},r&&new Array(9).fill(null).map((function(e,t){return se(ue,{key:t})})),!r&&(null==t?void 0:t.map((function(e){return se(ce,{key:e.priceId,id:e.priceId,label:e.metadata.title,cores:e.metadata.coresValue,priceFormatted:e.price.formatted})}))))},pe=r(73855),ve=u.createElement,fe=function(){var e=le(),t=e.amountNeeded,r=e.selectedProduct;return t&&r?ve(u.Fragment,null,ve(m.o5,{className:"w-full flex-1",type:m.kR.Callout,color:m.X8.Secondary},ve(m.o5,{tag:m.UL.Span,color:m.X8.Primary,bold:!0},(0,pe.rZ)(t)," Cores")," ","will be used to give the Award. The remaining"," ",ve(m.o5,{tag:m.UL.Span,color:m.X8.Primary,bold:!0},(0,pe.rZ)(r.value-t)," Cores")," ","will be added to your balance.")):ve(m.o5,{className:"w-full flex-1",type:m.kR.Callout,color:m.X8.Secondary},"Choose how many Cores to buy.")},me=r(30530),ye=r(53143),ge=r(80244),be=r(30794),Ce=r(61027);var he,ke=r(4315),we=r(13713),Pe=["origin","onCompletion","product"],Oe=u.createElement;function Ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ee=function(e){var t=e.className,r=e.title,n=e.showCoresAtCheckout;return Oe("div",{className:d()("flex-1",t)},r,Oe("div",{className:"flex flex-1 items-center justify-between gap-4"},Oe(fe,null),!!n&&Oe(z.T,{hideBuyButton:!0})),Oe(de,null))},Ne=function(e){var t=e.className,r=(0,Ce.p)();return Oe("div",{className:d()("flex-1",r&&"bg-black",t)},Oe("div",{className:"checkout-container"}))},Re=(he={},(0,o.A)(he,Y.kr.Created,"Checking your data..."),(0,o.A)(he,Y.kr.Processing,"Processing your payment, please wait..."),(0,o.A)(he,Y.kr.Success,"Almost done..."),(0,o.A)(he,Y.kr.ErrorRecoverable,"There was an issue, retrying..."),(0,o.A)(he,Y.kr.Error,Oe(u.Fragment,null,"Something went wrong!",Oe("br",null),Oe(Z(),{href:E.JY},Oe(m.o5,{type:m.kR.Footnote},Oe("u",null,"check status here"))))),he),xe=function(e){var t=e.transaction,r=Re[null==t?void 0:t.status]||Re[Y.kr.Processing],n=(null==t?void 0:t.status)===Y.kr.Error;return Oe(u.Fragment,null,Oe(b.t,{size:$.lK.XXXLarge}),Oe(m.o5,{type:m.kR.Title3,bold:!0},r),!n&&Oe(be.a,{className:"hidden tablet:block"}))},Te=function(){var e=le(),t=e.onCompletion,r=e.selectedProduct;return Oe(u.Fragment,null,Oe(b.t,{size:$.lK.XXXLarge}),Oe(m.o5,{type:m.kR.LargeTitle,bold:!0},(0,pe.rZ)(r.value)),Oe(m.o5,{type:m.kR.Title3,bold:!0},"You got your Cores!"),Oe(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary},"Success! Your Cores are now available in your balance."),Oe(y.$n,{onClick:t,variant:g.Ak.Primary,className:"w-full"},"Got it"))},je=function(){var e=le().error||{},t=e.title,r=e.description,n=e.onRequestClose;return Oe(u.Fragment,null,Oe(b.t,{size:$.lK.XXXLarge}),Oe(m.o5,{type:m.kR.Title3,bold:!0},t||"There was an error processing your transaction."),r&&Oe(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary},r),Oe(y.$n,{onClick:function(){null==n||n()},variant:g.Ak.Primary,className:"w-full"},"Got it"))},Ie=function(e){var t,r=(0,a.A)({},((0,n.A)(e),e)),o=(0,w.useRouter)(),i=(0,ge.Z2)(),s=i.user,d=i.updateUser,v=le(),m=v.onCompletion,y=v.activeStep,g=v.setActiveStep,b=v.error,C="PROCESSING"===y,h=(0,G.jE)(),k=(0,u.useCallback)((function(){return!C}),[C]),P=function(e){var t=e.message,r=void 0===t?"You have unsaved changes that will be lost if you leave the page":t,n=e.onValidateAction,a=(0,u.useRef)(!0),o=(0,w.useRouter)(),l=(0,u.useCallback)((function(){return!a.current||n()}),[n]);return(0,u.useEffect)((function(){if(o.isReady){var e=function(e){l()||(e.preventDefault(),e.returnValue=r)},t=function(){if(!l()&&!confirm(r))throw o.events.emit("routeChangeError"),new Error("Cancelling navigation")};return window.addEventListener("beforeunload",e),o.events.on("routeChangeStart",t),function(){window.removeEventListener("beforeunload",e),o.events.off("routeChangeStart",t)}}}),[l,r,o]),{onAskConfirmation:function(e){a.current=e}}}({message:ke.W.cores.error.transactionProcessing.description,onValidateAction:k}),O=P.onAskConfirmation,A=le().providerTransactionId,S=(0,p.I)({queryKey:[me.jZ.Transactions,{providerId:A}],queryFn:(t=(0,l.A)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Y.FW)({providerId:A});case 2:return null!=(t=e.sent)&&t.balance&&d(Se(Se({},s),{},{balance:t.balance})),h.invalidateQueries({queryKey:(0,me.$h)(me.jZ.Transactions,s),exact:!1}),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),enabled:!!A,refetchInterval:function(e){var t,r=null===(t=e.state.data)||void 0===t?void 0:t.status;return Math.max(e.state.dataUpdateCount,e.state.fetchFailureCount)>1e3*ye.xP/Y.Np?(O(!1),g({step:"PROCESSING_ERROR",error:{title:"Processing timed out",description:"Please check the status of your transaction in your Core Wallet.",onRequestClose:function(){o.push(E.JY)}}}),!1):[Y.kr.Created,Y.kr.Processing,Y.kr.ErrorRecoverable].includes(r)?Y.Np:([Y.kr.Error,Y.kr.InternalError].includes(r)&&(g({step:"PROCESSING_ERROR",error:{title:"There was an issue processing your transaction.",description:"Please contact support.",onRequestClose:function(){g({step:"INTRO"})}}}),O(!1)),!1)}}),N=S.data;return(0,u.useEffect)((function(){(null==N?void 0:N.status)===Y.kr.Success&&g({step:"COMPLETED",providerTransactionId:A})}),[null==N?void 0:N.status,A,g]),Oe(f.aF,(0,a.A)({kind:f.aF.Kind.FlexibleCenter,size:f.aF.Size.XSmall},r,{onRequestClose:function(){var e;return"PROCESSING_ERROR"===y?null==b||null===(e=b.onRequestClose)||void 0===e?void 0:e.call(b):m()},isDrawerOnMobile:!0}),Oe(f.aF.Body,{className:"flex items-center justify-center gap-4 text-center"},C&&Oe(xe,{transaction:N}),"COMPLETED"===y&&Oe(Te,null),"PROCESSING_ERROR"===y&&Oe(je,null)))},Fe=function(){var e=le(),t=e.selectedProduct,r=e.openCheckout,n=e.paddle;return(0,u.useEffect)((function(){n&&t&&r({priceId:t.id})}),[r,t,n]),Oe(H.c,{className:d()("bg-gradient-to-t from-theme-overlay-float-bun to-transparent",t&&"!p-0")},t?Oe(Ne,{className:"p-6"}):Oe(Ee,null))},_e=function(){return Oe("div",{className:"relative flex h-[582px] max-h-full flex-1"},Oe("video",{className:"bg-blue-500 absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 transform",poster:k.Ik,src:k.$0,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,disablePictureInPicture:!0,controls:!1}))},De=function(){var e=le().selectedProduct;return Oe(H.c,{className:d()("bg-gradient-to-t from-theme-overlay-float-bun to-transparent !p-0 tablet:rounded-b-16")},Oe("div",{className:"flex flex-1 flex-row"},Oe(Ee,{className:"p-6"}),Oe(Ne,{className:d()(!e&&"hidden","rounded-br-16 p-6")}),Oe("div",{className:d()("flex flex-1 overflow-hidden rounded-br-16",e&&"hidden")},!e&&Oe(_e,null))))},Me=function(e){var t=(0,a.A)({},((0,n.A)(e),e)),r=B().setActiveModal,o=(0,L.G6)(L.bh.MobileL),l=(0,we.P_)();return Oe(f.aF,(0,a.A)({kind:o?V.UB.FlexibleTop:f.aF.Kind.FlexibleCenter,size:f.aF.Size.XLarge,className:d()(o?void 0:"!h-[40rem]")},t),Oe(f.aF.Header,{title:o?void 0:"Get More Cores",className:"mr-auto flex-row-reverse justify-between gap-4 laptop:justify-end",showCloseButton:!o},Oe(z.T,{hideBuyButton:!l,onPlusClick:function(){return r("BUY_CORES")}}),o&&Oe(y.$n,{onClick:t.onRequestClose,variant:g.Ak.Tertiary,size:g.Mp.Small,className:"mr-2"},"Close")),Oe(o?Fe:De,null))},Be=function(e){var t=le().activeStep;return["PROCESSING","COMPLETED","PROCESSING_ERROR"].includes(t)?Oe(Ie,e):null},Xe=function(e){var t=(0,a.A)({},((0,n.A)(e),e)),r=le().activeStep;return Oe(u.Fragment,null,Oe(Be,t),"INTRO"===r&&Oe(Me,t))},Ue=function(e){var t=e.origin,r=e.onCompletion,n=e.product,a=(0,K.A)(e,Pe);return Oe(oe,{amountNeeded:null==n?void 0:n.value,onCompletion:r,origin:t},Oe(Xe,a))},Le=r(81602),qe=r(36899),Ve=r(76800),$e=u.createElement,ze=function(e){var t=e.className;return $e(m.o5,{type:m.kR.Footnote,color:m.X8.Quaternary,className:d()("text-center",t)},"Awards may include a revenue share with the recipient and are subject to our"," ",$e("a",{href:E.pc,target:"_blank",rel:Ve.O8,className:"font-bold underline"},"Terms of Service"),".")},Ke=r(58163),Ge=r(89883),We=u.createElement;function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ye=function(e){var t=e.item,r=e.onClick,n=B().logAwardEvent;return We(y.$n,{variant:g.Ak.Float,className:"flex !h-auto flex-col items-center justify-center rounded-14 bg-surface-float !p-1",onClick:function(e){return n({awardEvent:"PICK",extra:{award:t.value}}),r({product:t,event:e})}},We(h._V,{src:t.image,alt:t.name,className:"size-20 object-contain"}),We("div",{className:"flex items-center justify-center gap-1"},We(b.t,{size:$.lK.Size16}),We(m.o5,{type:m.kR.Footnote,color:m.X8.Secondary,tag:m.UL.Span},0===t.value?"Free":(0,pe.rZ)(t.value))))},Je=function(){var e,t=(0,Ge.d)().openModal,r=(0,u.useState)(!1),n=r[0],a=r[1],o=(0,ge.Z2)().user,l=B(),i=l.onRequestClose,c=l.entity,s=l.type,v=l.setActiveModal,C=l.setActiveStep,w=l.product,P=l.post,O=(0,L.G6)(L.bh.MobileL),A=(0,we.P_)(),S=(0,p.I)((0,Y.H9)()).data,E=function(){a(!1),v("BUY_CORES")},N=!!c.numAwards;return We(u.Fragment,null,We(f.aF.Header,{showCloseButton:!O,className:d()(O?"flex-row-reverse justify-between":void 0)},We(z.T,{hideBuyButton:!A,onPlusClick:E}),O?We(y.$n,{onClick:i,variant:g.Ak.Tertiary,size:g.Mp.Small,className:"mr-2"},"Close"):null),We(f.aF.Body,{className:"gap-2 bg-gradient-to-t from-theme-overlay-to to-transparent tablet:rounded-b-16"},We("div",{className:"flex flex-col items-center justify-center gap-2 px-4"},We(h._V,{src:N?k.Xr:c.receiver.image,alt:"Award user",className:N?"size-[7.5rem]":"size-16 rounded-18"}),We(m.o5,{type:m.kR.Title3,bold:!0,color:m.X8.Primary},N?We(u.Fragment,null,(0,Le.Kt)(c.numAwards)," Award",1===c.numAwards?"":"s"," given"):We(u.Fragment,null,"Give an Award"))),N&&We(y.$n,{className:"mx-auto max-w-28",size:g.Mp.Small,variant:g.Ak.Float,onClick:function(){t({type:V.K2.ListAwards,props:{onBack:function(){t({type:V.K2.GiveAward,props:{type:s,entity:c,post:P}})},queryProps:{id:c.id,type:s}}})}},"Show all →"),We(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"text-center"},"Show your appreciation! Pick an Award to send to"," ",We(m.o5,{type:m.kR.Callout,color:m.X8.Primary,tag:m.UL.Span,bold:!0},c.receiver.name||"@".concat(c.receiver.username)),"!"),We("div",{className:"mt-4 grid grid-cols-3 gap-2 tablet:grid-cols-4"},null==S||null===(e=S.edges)||void 0===e?void 0:e.map((function(e){var t=e.node;return We(Ye,{key:t.id,item:t,onClick:function(e){var t=e.product;if(t.value>o.balance.amount)return C({screen:"INTRO",product:t}),void a(!0);a(!1),C({screen:"COMMENT",product:t})}})})))),n&&!!w&&We(f.aF.Footer,{className:"!h-auto flex-col",justify:X.F1.Center},A&&We(y.$n,{className:"w-full",variant:g.Ak.Primary,onClick:E},"Buy Cores ",We(b.t,null)," ",0===w.value?"Free":(0,pe.rZ)(w.value)),!A&&We(y.$n,{className:"w-full",variant:g.Ak.Primary,disabled:!0},We("span",{className:"inline-flex gap-1"}," ","Insufficient Cores",We(b.t,{secondary:!0})," "),0===w.value?"Free":(0,pe.rZ)(w.value)),We(ze,null)))},Qe=function(){var e,t,r=(0,ge.Z2)(),n=r.updateUser,a=r.user,o=B(),i=o.setActiveStep,s=o.type,d=o.entity,p=o.product,k=o.logAwardEvent,w=(0,L.G6)(L.bh.MobileL),P=(0,q.mu)().displayToast,O=(0,u.useState)(""),A=O[0],S=O[1],E=(0,v.n)({mutationKey:["awards",{productId:null==p?void 0:p.id,type:s,entityId:d.id,note:A}],mutationFn:Y.CX,onSuccess:(t=(0,l.A)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(He(He({},a),{},{balance:t.balance}));case 2:i({screen:"SUCCESS",product:p});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),onError:(e=(0,l.A)(c().mark((function e(t){var r,o,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(r=t.response.errors)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.extensions)||void 0===r?void 0:r.code)!==qe.hD.BalanceTransactionError){e.next=5;break}if((l=t.response.errors[0]).extensions.status!==Y.kr.InsufficientFunds||!l.extensions.balance){e.next=5;break}return e.next=5,n(He(He({},a),{},{balance:l.extensions.balance}));case 5:P((null==t||null===(o=t.response)||void 0===o||null===(o=o.errors)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.message)||ke.W.error.generic);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}),N=E.mutate,R=E.isPending,x=(0,u.useCallback)((function(){k({awardEvent:"AWARD",extra:{award:p.value}}),N({productId:p.id,type:s,entityId:d.id,note:A})}),[N,d.id,k,A,p.id,p.value,s]),T=!!d.numAwards;return We(u.Fragment,null,We(f.aF.Header,{title:"Give an Award",showCloseButton:!w},We(y.$n,{variant:g.Ak.Tertiary,onClick:function(){return i({screen:"INTRO"})},size:g.Mp.Small,className:"mr-2 flex -rotate-90",icon:We(C.HK,null)})),We(f.aF.Body,null,We("div",{className:"mb-4 flex flex-col items-center justify-center gap-2"},We(h._V,{src:T?p.image:d.receiver.image,alt:"Award user",className:T?"size-[7.5rem]":"size-16 rounded-18"}),We(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"text-center"},"Awesome choice! We're sure that"," ",We(m.o5,{bold:!0,type:m.kR.Callout,color:m.X8.Primary,tag:m.UL.Span},d.receiver.name||"@".concat(d.receiver.username))," ","will appreciate this award!")),We("form",{action:"#",className:"flex flex-1 flex-col"},We(U.A,{allowPreview:!1,textareaProps:{name:"content",rows:6,placeholder:"Share a few words about why this Award is well deserved (optional)",maxLength:400},className:{container:"flex-1"},initialContent:"",enabledCommand:{upload:!1,link:!1,mention:!1},showMarkdownGuide:!1,onValueUpdate:function(e){return S(e)}}))),We(f.aF.Footer,{className:"!h-auto flex-col",justify:X.F1.Center},We(y.$n,{loading:R,className:"w-full",variant:g.Ak.Primary,onClick:x},"Send Award for ",We(b.t,null)," ",0===p.value?"Free":(0,pe.rZ)(p.value)),We(ze,null)))},et=function(){var e,t=B(),r=t.entity,n=t.product,a=t.onRequestClose,o=(0,L.G6)(L.bh.MobileL);return We(f.aF.Body,null,We("div",{className:"flex flex-col items-center justify-center gap-4"},We("div",{className:"flex flex-col gap-2"},We(h._V,{src:n.image,alt:null==n||null===(e=n.flags)||void 0===e?void 0:e.description,className:"size-20"}),We("div",{className:"flex items-center justify-center gap-1"},We(b.t,{size:$.lK.Size16,className:"text-accent-bun-default"}),We(m.o5,{type:m.kR.Footnote,color:m.X8.Secondary,tag:m.UL.Span},0===n.value?"Free":(0,pe.rZ)(n.value)))),We("div",{className:"flex flex-col gap-2"},We(m.o5,{type:m.kR.Title3,color:m.X8.Primary,bold:!0,className:"text-center"},"Congrats! Your Award has been sent to"," ",r.receiver.name||"@".concat(r.receiver.username)),We(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"text-center"},"Thanks for supporting the community!")),!o&&We(y.$n,{variant:g.Ak.Primary,className:"w-full",onClick:function(){a(void 0)}},"Close")))},tt=function(){var e=B().activeStep;return We(u.Fragment,null,"INTRO"===e?We(Je,null):null,"COMMENT"===e?We(Qe,null):null,"SUCCESS"===e?We(et,null):null)},rt=function(e){var t,r=(0,a.A)({},((0,n.A)(e),e)),o=(0,L.G6)(L.bh.MobileL),l=B(),i=l.activeStep,c=l.activeModal,s=l.setActiveModal,p=l.product,v=l.logAwardEvent,m=l.onRequestClose,y=(0,u.useRef)(!1);(0,u.useEffect)((function(){y.current||(y.current=!0,v({awardEvent:"START"}))}),[v]);var g=(0,u.useCallback)((function(){s("AWARD")}),[s]),b=(0,u.useCallback)((function(){s("AWARD")}),[s]);return We(u.Fragment,null,"AWARD_ANIMATION"===c&&We(Ke.b,{src:(null==p||null===(t=p.flags)||void 0===t?void 0:t.imageGlow)||(null==p?void 0:p.image),alt:null==p?void 0:p.name,onDone:function(){var e;null===(e=r.onRequestClose)||void 0===e||e.call(r,void 0)}}),"AWARD"===c?We(f.aF,(0,a.A)({kind:o?V.UB.FlexibleTop:f.aF.Kind.FlexibleCenter,size:f.aF.Size.Small,className:d()(o||"SUCCESS"===i?void 0:"!h-[40rem]"),isDrawerOnMobile:"SUCCESS"===i,drawerProps:{instantOpen:!0}},r,{onRequestClose:m}),We(tt,null)):null,"BUY_CORES"===c?We(Ue,(0,a.A)({},r,{onCompletion:g,onRequestClose:b,product:p,origin:A.$e.Award})):null)};const nt=function(e){return We(M,e,We(rt,e))}},83362:(e,t,r)=>{"use strict";r.d(t,{Ey:()=>v,Ju:()=>y,U8:()=>b,_Q:()=>C});var n,a,o,l,i=r(89338),c=r(91591),u=r(2827),s=r.n(u),d=r(2972),p=r(36899),v=function(e){return e.Plus="plus",e.Cores="cores",e}({}),f=(0,d.gql)(n||(n=(0,c.A)(["\n  fragment PricingMetadataFragment on ProductPricingMetadata {\n    appsId\n    title\n    caption {\n      copy\n      color\n    }\n    idMap {\n      paddle\n      ios\n    }\n    coresValue\n  }\n"]))),m=(0,d.gql)(a||(a=(0,c.A)(["\n  query PricingPreview($type: PricingType, $locale: String) {\n    pricingPreview(type: $type, locale: $locale) {\n      metadata {\n        ...PricingMetadataFragment\n      }\n      priceId\n      price {\n        amount\n        formatted\n        monthly {\n          amount\n          formatted\n        }\n        daily {\n          amount\n          formatted\n        }\n      }\n      currency {\n        code\n        symbol\n      }\n      duration\n    }\n  }\n  ","\n"])),f),y=function(){var e=(0,i.A)(s().mark((function e(t){var r,n,a,o,l,i=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:null!==(r=null===globalThis||void 0===globalThis||null===(n=globalThis.navigator)||void 0===n?void 0:n.language)&&void 0!==r?r:"en-US",e.next=3,p.e.request(m,{type:t,locale:a});case 3:return o=e.sent,l=o.pricingPreview,e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=((0,d.gql)(o||(o=(0,c.A)(["\n  query PricingPreviewByIds($ids: [String]!, $locale: String) {\n    pricingPreviewByIds(ids: $ids, locale: $locale) {\n      priceId\n      price {\n        amount\n        formatted\n        monthly {\n          amount\n          formatted\n        }\n        daily {\n          amount\n          formatted\n        }\n      }\n      currency {\n        code\n        symbol\n      }\n      duration\n      trialPeriod {\n        interval\n        frequency\n      }\n    }\n  }\n"]))),(0,d.gql)(l||(l=(0,c.A)(["\n  query PricingMetadata($type: PricingType) {\n    pricingMetadata(type: $type) {\n      ...PricingMetadataFragment\n    }\n  }\n  ","\n"])),f)),b=function(){var e=(0,i.A)(s().mark((function e(t){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.e.request(g,{type:t});case 2:return r=e.sent,n=r.pricingMetadata,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){return e.Success="success",e.Help="help",e}({})},89334:(e,t,r)=>{"use strict";r.d(t,{W:()=>f});var n=r(50122),a=r(22155),o=r(15132),l=r(9487),i=r(80244),c=r(61663),u=r(57952),s=r(54883),d=r(68390);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(e){var t=e.successCallback,r=e.disabledEvents,n=e.targetType,p=e.getProductQuantity,f=(0,l.useRouter)(),m=(0,c.DX)().logEvent,y=(0,i.Z2)(),g=y.user,b=y.geo,C=(0,a.useState)(),h=C[0],k=C[1],w=(0,a.useRef)(!1),P=(0,a.useRef)();P.current=m;var O=(0,a.useRef)(t);O.current=t;var A=(0,a.useRef)(p);A.current=p,(0,a.useEffect)((function(){(0,d.oX)()||(w.current=!1,(0,o.initializePaddle)({environment:"MISSING_ENV_VAR".NEXT_PUBLIC_PADDLE_ENVIRONMENT||"production",token:"topsecret",eventCallback:function(e){var t,a,l,i,c,d,p;if(null==r||!r.includes(null==e?void 0:e.name)){var v=(null==e||null===(t=e.data)||void 0===t?void 0:t.custom_data)||{};switch(null==e?void 0:e.name){case o.CheckoutEventNames.CHECKOUT_PAYMENT_INITIATED:P.current({target_type:n,event_name:u.VB.InitiatePayment,target_id:null==e||null===(a=e.data)||void 0===a?void 0:a.payment.method_details.type});break;case o.CheckoutEventNames.CHECKOUT_LOADED:w.current=!0,P.current({target_type:n,event_name:u.VB.InitiateCheckout,target_id:null==e||null===(l=e.data)||void 0===l?void 0:l.payment.method_details.type});break;case o.CheckoutEventNames.CHECKOUT_PAYMENT_SELECTED:P.current({target_type:n,event_name:u.VB.SelectCheckoutPayment,target_id:null==e||null===(i=e.data)||void 0===i?void 0:i.payment.method_details.type});break;case o.CheckoutEventNames.CHECKOUT_COMPLETED:w.current=!1,P.current({target_type:n,event_name:u.VB.CompleteCheckout,extra:JSON.stringify({user_id:"gifter_id"in v&&"user_id"in v?v.user_id:void 0,quantity:null===(c=A.current)||void 0===c?void 0:c.call(A,e),localCost:null==e?void 0:e.data.totals.total,localCurrency:null==e?void 0:e.data.currency_code,payment:null==e?void 0:e.data.payment.method_details.type,cycle:null!==(d=null==e||null===(p=e.data.items)||void 0===p||null===(p=p[0])||void 0===p||null===(p=p.billing_cycle)||void 0===p?void 0:p.interval)&&void 0!==d?d:"one-off"})}),O.current?O.current(e):f.push(s.j$);break;case"checkout.warning":P.current({target_type:n,event_name:u.VB.WarningCheckout});break;case o.CheckoutEventNames.CHECKOUT_ERROR:P.current({target_type:n,event_name:u.VB.ErrorCheckout});break;case o.CheckoutEventNames.CHECKOUT_CLOSED:w.current=!1}}},checkout:{settings:{displayMode:"inline",frameTarget:"checkout-container",frameInitialHeight:500,frameStyle:"width: 100%; background-color: transparent; border: none;",theme:"dark",variant:"one-page"}}}).then((function(e){e&&k(e)})))}),[f,r,n]);var S=(0,a.useCallback)((function(e){var t=e.priceId,r=e.giftToUserId,n=e.discountId,a=[{priceId:t,quantity:1}],o=v(v({},null!=g&&g.email?{email:null==g?void 0:g.email}:{id:"anonymous"}),(null==b?void 0:b.region)&&{address:{countryCode:null==b?void 0:b.region}}),l=v({user_id:null!=r?r:null==g?void 0:g.id},!!r&&{gifter_id:null==g?void 0:g.id});w.current?null==h||h.Checkout.updateItems(a):null==h||h.Checkout.open({items:a,customer:o,customData:l,discountId:n})}),[null==h?void 0:h.Checkout,null==g?void 0:g.email,null==g?void 0:g.id,null==b?void 0:b.region]);return{paddle:h,openCheckout:S,isPaddleReady:!!h}}},7941:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(14243),a=r(80244),o=r(83362),l=r(30530),i=function(e){var t=e.type,r=e.locale,i=e.enabled,c=void 0===i||i,u=(0,a.Z2)(),s=u.user,d=u.isValidRegion;return(0,n.I)({queryKey:(0,l.$h)(l.jZ.PricePreview,s,t,r),queryFn:function(){return(0,o.Ju)(t,r)},enabled:c&&d,staleTime:l.b2.Default})}},73855:(e,t,r)=>{"use strict";r.d(t,{PK:()=>l,rZ:()=>c,vv:()=>i});var n=r(50122),a=r(81602);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var l=function(e){return"string"==typeof e&&"true"===e.toLowerCase()},i=function(e,t){return"number"!=typeof e?"":e.toLocaleString(["en-US"],function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({minimumFractionDigits:2,maximumFractionDigits:2},t))},c=function(e){return e>1e5?(0,a.Kt)(e):i(e,{minimumFractionDigits:0})}},15132:()=>{},11999:(e,t,r)=>{"use strict";function n(e){if(null==e)throw new TypeError("Cannot destructure "+e)}r.d(t,{A:()=>n})}}]);