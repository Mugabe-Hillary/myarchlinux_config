/*! For license information please see content.js.LICENSE.txt */
try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d4cd110b-4377-4b84-9857-e3d6fea1d706",e._sentryDebugIdIdentifier="sentry-dbid-d4cd110b-4377-4b84-9857-e3d6fea1d706")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"4.20.1"};(()=>{"use strict";var e,t={d:(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{ACCOUNT_STATUS_RECHECK_INTERVAL:()=>E,AUTO_LOGIN_URL:()=>f,BASE_REPHRASING_SERVER_URL:()=>O,BASE_SERVER_URL:()=>S,CHANGELOG_CHECK_INTERVAL:()=>R,CHECK_DELAY:()=>z,CHECK_MAX_DELAY:()=>J,CHECK_RECOMMENDATION_DELAY:()=>Q,CHECK_REQUEST_TIMEOUT:()=>A,CHECK_THROTTLING_LIMIT:()=>T,CLIENT_LOGIN_URL:()=>G,COLORS:()=>oe,COLORS_ON_DARK:()=>Ee,COUNTRY_COUPON_MAPPING:()=>Te,COUPON_INTERVAL:()=>pe,CURRENT_TERMS_OF_SERVICE_VERSION:()=>Fe,DEFAULT_MAX_FIX_ALL_ERRORS_COUNT:()=>$,DICTIONARY_SYNC_INTERVAL:()=>g,EDITOR_GROUP_ATTRIBUTE:()=>Be,EMPLOYEE_EMAIL_REGEXP:()=>ie,ERRORS_THAT_CAN_BE_CORRECTED_ALL_AT_ONCE:()=>Se,EXTENSION_HEALTH_RECHECK_INTERVAL:()=>i,EXTERNAL_CONFIG_RELOAD_INTERVAL:()=>l,EXTERNAL_CONFIG_URL:()=>U,FEEDBACK_SERVER_URL:()=>v,FIX_SENTENCE_MIN_ERROR_AMOUNT:()=>he,HOVER_DELAY:()=>te,HOVER_MAX_DELAY:()=>re,HTTP_ERROR_ABORT:()=>Ge,HTTP_ERROR_GENERIC:()=>ye,HTTP_ERROR_PAYLOAD_TOO_LARGE:()=>be,HTTP_ERROR_TIMEOUT:()=>xe,IFRAME_INITILIZATION_RECHECK_INTERVAL:()=>c,INSTALL_URL:()=>I,INVISIBLE_SEPARATOR:()=>We,LOCAL_SERVER_URL:()=>M,MAIN_FALLBACK_SERVER_URL:()=>L,MAIN_SERVER_RECHECK_INTERVAL:()=>k,MAIN_SERVER_URL:()=>C,MASCOT_NAME:()=>Ne,MAX_EXCEPTION_COUNT:()=>_e,MAX_FIXES_COUNT:()=>le,MAX_FREEMIUM_REPHRASINGS_PER_DAY:()=>Pe,MAX_PHRASE_LENGTH_IN_WORDS:()=>de,MAX_TEXT_LENGTH:()=>X,MAX_TEXT_LENGTH_CUSTOM_SERVER:()=>q,MAX_TEXT_LENGTH_PERFORMANCE_DEGRADATION:()=>K,MAX_TEXT_LENGTH_PREMIUM:()=>V,MAX_USAGE_COUNT_ONBOARDING:()=>ue,MIN_TEXT_LENGTH:()=>W,NARROW_WHITESPACE_REGEXP:()=>Me,NEW_SYNONYMS_URL:()=>H,PACKAGE:()=>Ie,PARAGRAPH_LEVEL_CHUNK_LENGTH:()=>j,PICKY_RULES_THAT_ARE_CONSIDERED_ANNOYING:()=>me,PING_INTERVAL:()=>_,PING_URL:()=>b,PREMIUM_FALLBACK_SERVER_URL:()=>D,PREMIUM_SERVER_URL:()=>P,PRIVACY_POLICY_URL:()=>ke,QUOTE_AT_BEGINNING_REGEXP:()=>Ue,QUOTE_AT_END_REGEXP:()=>ve,RELIABLE_MOTHER_TONGUES:()=>Le,RENDER_INTERVAL:()=>d,REPHRASE_MODE_ACADEMIC:()=>Ve,REPHRASE_MODE_CREATIVE:()=>qe,REPHRASE_MODE_EXPAND:()=>$e,REPHRASE_MODE_FLUENCY:()=>Ke,REPHRASE_MODE_FORMALITY:()=>Ze,REPHRASE_MODE_SHORTEN:()=>je,REPHRASE_MODE_SIMPLICITY:()=>Ye,REPHRASE_MODE_STANDARD:()=>Xe,RTL_LANGUAGES:()=>Ce,RULES_ALLOWED_TO_BE_SENT_TO_API:()=>fe,SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES_INTERVAL:()=>ae,SERVER_MAX_TEXT_LENGTH_BASIC:()=>Y,SHORT_TEXT_MAX_LENGTH:()=>B,SPLIT_SENTENCE_LIMIT:()=>p,STATISTICS_URL:()=>y,STOPPED_TYPING_TIMEOUT:()=>ee,SUPPORTED_FIX_COMPLETE_SENTENCE_LANGUAGES:()=>Re,SUPPORTED_REPHRASE_LANGUAGES:()=>ce,SUPPORTED_SENTENCE_SPLITTING_LANGUAGES:()=>ge,SUPPORTED_SYNONYM_LANGUAGES:()=>Ae,SWITCH_TO_FALLBACK_SERVER_ERRORS:()=>w,SYNC_USER_DATA_INTERVAL:()=>u,TERMS_OF_SERVICE_API_URL:()=>F,TERMS_OF_SERVICE_URL:()=>we,TEXT_LEVEL_MAX_LENGTH_PER_REQUEST:()=>Z,TOOLBAR_DECREASE_SIZE_INTERVAL:()=>h,TOOLBOX_THEME:()=>He,TRACK_RULE_EVENT_LANGUAGES:()=>Oe,TRAILING_WHITESPACE_REGEXP:()=>De,UI_MODE_RECHECK_INTERVAL:()=>o,UNINSTALL_URL:()=>m,USER_ACTIVITY_DESTRUCTION_DELAY:()=>ne,USER_ACTIVITY_PING_INTERVAL_LENGTH:()=>se,USER_DATA_URL:()=>N,WEBAPI_URL:()=>x}),function(e){e.CHROME_EXTENSION_ID="CHROME_EXTENSION_ID",e.SHOW_PARTIAL_RECO_UNDERLINE="SHOW_PARTIAL_RECO_UNDERLINE",e.EXTN_PREFIX="EVENT_PREFIX",e.COLORS_GRAMMAR="COLORS_GRAMMAR",e.CARD_LAYOUT="CARD_LAYOUT",e.COLORS_SPELLING="COLORS_SPELLING",e.COLORS_STYLE="COLORS_LONG_SENTENCE",e.SUPPORTED_LANGUAGES="SUPPORTED_LANGUAGES",e.INSTALLED_ATTRIBUTE="INSTALLED_ATTRIBUTE",e.SITE_INIT_ATTRIBUTE="SITE_INIT_ATTRIBUTE",e.INPUT_AREA_INIT_ATTRIBUTE="INPUT_AREA_INIT_ATTRIBUTE",e.TMP_ID_ATTRIBUTE="TMP_ID_ATTRIBUTE",e.AI_RULE_ID_REGEX="AI_RULE_ID_REGEX",e.COLORS_PARAPHRASE="COLORS_PARAPHRASE",e.COLORS_RECOMMENDATION="COLORS_RECOMMENDATION",e.COLORS_RECOMMENDATION_TEASE="COLORS_RECOMMENDATION_TEASE",e.VALID_START_SENTENCE_REGEX="VALID_START_SENTENCE_REGEX",e.VALID_END_SENTENCE_REGEX="VALID_END_SENTENCE_REGEX",e.MULTI_SENTENCE_SELECTION_FOR_PARAPHRASE_ALLOWED="MULTI_SENTENCE_SELECTION_FOR_PARAPHRASE_ALLOWED",e.MAX_TEXT_LENGTH_ALLOWED_FOR_PAGELESS="MAX_TEXT_LENGTH_ALLOWED_FOR_PAGELESS",e.MAX_TEXT_LENGTH_ALLOWED="MAX_TEXT_LENGTH_ALLOWED",e.SELECTED_UNDERLINE_THICKNESS="SELECTED_UNDERLINE_THICKNESS",e.BULLET_POINT_PARSING_PREFIX="BULLET_POINT_PARSING_PREFIX",e.TOOLBAR_SIZE="TOOLBAR_SIZE",e.FIX_ALL_CONFIG="FIX_ALL_CONFIG",e.IGNORE_EDITOR_WITH_ATTRIBUTES="IGNORE_EDITOR_WITH_ATTRIBUTES",e.SHOW_TOOLBAR_ON_EMPTY_INPUT_AREA="SHOW_TOOLBAR_ON_EMPTY_INPUT_AREA",e.MAIN_CONTENT_SCRIPT_FILENAME="MAIN_CONTENT_SCRIPT_FILENAME",e.SPECIAL_INTRODUCTORY_TEASER_ENABLED="SPECIAL_INTRODUCTORY_TEASER_ENABLED",e.TERMS_OF_SERVICE_MODAL_ENABLED="TERMS_OF_SERVICE_MODAL_ENABLED",e.LOLLIPOP_CONFIG="LOLLIPOP_CONFIG",e.NORMALIZE_SPACE="NORMALIZE_SPACE",e.USE_CSS_CUSTOM_HIGHLIGHTS="USE_CSS_CUSTOM_HIGHLIGHTS",e.STRIP_WRAPPING_QUOTES_FROM_SENTENCE="STRIP_WRAPPING_QUOTES_FROM_SENTENCE"}(e||(e={}));const s={[e.CHROME_EXTENSION_ID]:"oldceeleldhonbafppcapldpdifcinji",[e.NORMALIZE_SPACE]:!1,[e.SHOW_PARTIAL_RECO_UNDERLINE]:!1,[e.EXTN_PREFIX]:"lt",[e.COLORS_GRAMMAR]:{UNDERLINE:"#f2b24c",SELECTED_UNDERLINE:"#f2b24c",BACKGROUND:"rgba(242,179,77,0.3)",EMPHASIZE:"rgba(241,179,76,0.1)"},[e.COLORS_SPELLING]:{UNDERLINE:"#EB5757",SELECTED_UNDERLINE:"#EB5757",BACKGROUND:"rgba(235,88,88,0.2)",EMPHASIZE:"rgba(239,88,88,0.1)"},[e.COLORS_STYLE]:{UNDERLINE:"#8F7FFF",SELECTED_UNDERLINE:"#8F7FFF",BACKGROUND:"rgba(142,128,255,0.2)",EMPHASIZE:"rgba(138,128,255,0.2)",TITLE:"#5C4CFF"},[e.COLORS_PARAPHRASE]:{UNDERLINE:"#8F7FFF",BACKGROUND:"rgba(142,128,255,0.2)",EMPHASIZE:"rgba(138,128,255,0.2)",TITLE:"#5C4CFF"},[e.COLORS_RECOMMENDATION]:{UNDERLINE:"#80B3E2",SELECTED_UNDERLINE:"#0067C5",BACKGROUND:"rgba(0, 103, 199, 0.16)",EMPHASIZE:"rgba(0, 103, 199, 0.16)"},[e.COLORS_RECOMMENDATION_TEASE]:{UNDERLINE:"#CF9F0280",SELECTED_UNDERLINE:"#CF9F02",BACKGROUND:"rgba(242,181,24,0.16)",EMPHASIZE:"rgba(242,181,24,0.16)"},[e.SUPPORTED_LANGUAGES]:["ar","ast-es","be-by","br-fr","ca-es","ca-es-valencia","crh-ua","da-dk","de-at","de-ch","de-de","el-gr","en-au","en-ca","en-gb","en-nz","en-us","en-za","eo","es","fa","ga-ie","fr","gl-es","it","ja-jp","km-kh","nl","no","pl-pl","pt-ao","pt-br","pt-mz","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sv","ta-in","tl-ph","uk-ua","zh-cn"],[e.CARD_LAYOUT]:{TARGET_BOX_HORIZONTAL_MARGIN:0,TARGET_BOX_VERTICAL_MARGIN:5,HEADER_HEIGHT:36,FOOTER_HEIGHT:36,KEYBOARD_HINT_HEIGHT:60,MIN_HEIGHT_PARAPHRASE:200,MIN_HEIGHT_TOOLBOX:230,MAX_HEIGHT_TOOLBOX:368},[e.INSTALLED_ATTRIBUTE]:"data-lt-installed",[e.SITE_INIT_ATTRIBUTE]:"data-lt-site",[e.INPUT_AREA_INIT_ATTRIBUTE]:"data-lt-tweaks",[e.TMP_ID_ATTRIBUTE]:"data-lt-tmp-id",[e.AI_RULE_ID_REGEX]:/^(QB|AI)_/,[e.VALID_START_SENTENCE_REGEX]:"[^\u2022]",[e.VALID_END_SENTENCE_REGEX]:".",[e.MULTI_SENTENCE_SELECTION_FOR_PARAPHRASE_ALLOWED]:!1,[e.MAX_TEXT_LENGTH_ALLOWED_FOR_PAGELESS]:15e3,[e.MAX_TEXT_LENGTH_ALLOWED]:1e4,[e.SELECTED_UNDERLINE_THICKNESS]:2,[e.BULLET_POINT_PARSING_PREFIX]:"\u2022 ",[e.TOOLBAR_SIZE]:{width:20,height:20},[e.FIX_ALL_CONFIG]:{FIX_GC_ERRORS:!0,FIX_RECOMMENDATIONS:!1,FIX_STYLE_ERRORS:!1},[e.IGNORE_EDITOR_WITH_ATTRIBUTES]:["spellcheck"],[e.SHOW_TOOLBAR_ON_EMPTY_INPUT_AREA]:!1,[e.MAIN_CONTENT_SCRIPT_FILENAME]:"/content.js",[e.SPECIAL_INTRODUCTORY_TEASER_ENABLED]:!0,[e.TERMS_OF_SERVICE_MODAL_ENABLED]:!0,[e.LOLLIPOP_CONFIG]:{LOLLIPOP_FREEZE_STATE_COLOR:"purple",LOLLIPOP_CSS_PATH:"/content/styles/lollipop.css",ONBOARDING_IMAGE_PATH:"/assets/images/toolbox/lollipop-onboarding-lt.webp",ONBOARDING_BORDER_RADIUS:"8px",LOLLIPOP_CIRCLE_IMAGE_PATH:"/assets/images/toolbox/lollipop-icon.svg",LOLLIPOP_CIRCLE_GDOCS_IMAGE_PATH:"/assets/images/toolbox/lollipop-icon-gdocs.svg",SUPPORTS_DARK_MODE:!0,ONBOARDING_LANDING_PAGE_URL:"https://languagetool.org/text-cursor",TOOLBOX_IFRAME_PATH:"/toolbox/toolbox.html"},[e.STRIP_WRAPPING_QUOTES_FROM_SENTENCE]:!0,[e.USE_CSS_CUSTOM_HIGHLIGHTS]:!1};class n{static getInstance(){return this.instance||self._qb_lt_config||(this.instance=new n,self._qb_lt_config=this.instance),this.instance||self._qb_lt_config}get(e){return this.extnConfig[e]}set(e,t){this.extnConfig[e]=t}setAll(e){this.extnConfig=e}getAll(){return this.extnConfig}constructor(){this.extnConfig=s}}var a=n.getInstance();const i=3e3,o=6e4,E=36e5,l=144e5,_=864e5,u=864e5,c=1500,g=72e5,R=144e5,d=300,h=900,A=5e4,T=30,p=500,I="https://languagetool.org/webextension/welcome",m="https://languagetool.org/webextension/uninstall",f="https://languagetool.org/webextension/login",N="https://languagetool.org/webextension/user",S="https://api.languagetool.org",O="https://rewriting.languagetoolplus.com",C=`${S}/v2`,L="https://api-fallback.languagetool.org/v2",P="https://api.languagetoolplus.com/v2",D="https://languagetoolplus.com/api/v2",M="http://localhost:8081/v2",v="https://languagetool.org/send-feedback/",U="https://languagetool.org/webextension_config.json",G="https://languagetool.org/client-login",b="https://languagetool.org/ping",x="https://languagetool.org/webapi",y="https://api.languagetoolplus.com/statistics/api/store",H="https://qb-grammar-en.languagetool.org/phrasal-paraphraser/subscribe",F="https://languagetool.org/users/privacy-policy/",w=[502,503,504],k=18e4,W=4,B=50,X=a.get(e.MAX_TEXT_LENGTH_ALLOWED),Y=19500,Z=Y,K=4e4,V=15e4,q=Number.MAX_SAFE_INTEGER,$=50,j=5e3,z=1500,J=4e3,Q=3e3,ee=2e3,te=50,re=200,se=2e4,ne=3e5,ae=6e5,ie=/@(languagetool(er)?|quillbot|scribbr|learneo|coursehero|symbolab|litcharts|spellboy)\.(com|org|de|nl)$/i,oe={get GRAMMAR(){return a.get(e.COLORS_GRAMMAR)},get STYLE(){return a.get(e.COLORS_STYLE)},get PARAPHRASE(){return a.get(e.COLORS_PARAPHRASE)},get LONG_SENTENCE(){return{UNDERLINE:"#D2CBFF",BACKGROUND:"rgba(210,203,255,0.2)",EMPHASIZE:"rgba(210,203,255,0.1)"}},get IGNORED_RANGE(){return{UNDERLINE:"#00bbe6",BACKGROUND:"rgb(92, 222, 251, 0.2)",EMPHASIZE:"rgb(154, 232, 250, 0.1)"}},get RECOMMENDATION(){return a.get(e.COLORS_RECOMMENDATION)},get RECOMMENDATION_TEASE(){return a.get(e.COLORS_RECOMMENDATION_TEASE)},get SPELLING(){return a.get(e.COLORS_SPELLING)},get SYNONYMS(){return{UNDERLINE:"#0042d7"}},get NEW_SENTENCE(){return{BACKGROUND:"rgba(30, 225, 151, 0.2)"}},get DISABLED(){return{UNDERLINE:"rgba(0, 0, 0, 0.2)",BACKGROUND:"rgba(0, 0, 0, 0.2)",EMPHASIZE:"rgba(0, 0, 0, 0.2)",TITLE:"rgba(0, 0, 0, 0.2)"}}},Ee={...oe,DISABLED:{UNDERLINE:"rgba(255, 255, 255, 0.3)",BACKGROUND:"rgba(255, 255, 255, 0.3)",EMPHASIZE:"rgba(255, 255, 255, 0.3)",TITLE:"rgba(255, 255, 255, 0.3)"}},le=5,_e=6,ue=5,ce=["en","de","fr","nl","es","pt-BR","pt-PT"],ge=["en"],Re=["en"],de=10,he=3,Ae=["de","de-CH","ru","sv","pt","pt-BR","el","en","eo","it","fr","es","uk","sk","sl","pl","da","ro","nl","ca"],Te={UKRAINE:{countries:["UA","BY"],percent:50},"ITALY-DISCOUNT":{countries:["IT"],percent:20},"SPAIN-DISCOUNT":{countries:["ES"],percent:20},SOUTH_EUROPE:{countries:["RO","AL","GR","ME","EE","LT","LV","BG","CY","MT","SK","SI","RS","HR","XK","HU","MD","TR","PT"],percent:20},AFRICA:{countries:["NG","ET","EG","CD","CG","TZ","KE","UG","DZ","SD","MA","AO","MZ","TN","CI","DJ","SZ","MU","GQ","GA","BW","SO","CD","ER","MG"],percent:50},ASIA:{countries:["ID","PK","BD","VN","MM","PH","UZ","MY","NP","KZ","KH","UZ","TH","YE","SY","JO"],percent:50},LATIN_AMERICA:{countries:["PE","VE","EC","SV","DO","BO","SR","AR","HN","BZ","CR","PA","GT","NI","GY","UY","HT","JM","TT","CU"],percent:50},BRAZIL:{countries:["BR"],percent:50}},pe=7776e6,Ie={BASIC:"Basic",PREMIUM:"Premium"},me=["EN_QUOTES","PASSIVE_VOICE","DASH_RULE","SENTENCE_FRAGMENT","PONCTUATION_DOUBLE","TOO_LONG_SENTENCE","COMETES_TIPOGRAFIQUES","APOSTROF_TIPOGRAFIC","FALSCHE_VERWENDUNG_DES_BINDESTRICHS","HALBGEVIERTSTRICH","PARAGRAF_LEERZEICHEN","TYPOGRAFISCHE_APOSTROPHE","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2","PUNCTUATION_PARAGRAPH_END","FINAL_STOPS","FINAL_PUNCTUATION","SMART_QUOTES","PT_SMART_QUOTES","DASH_SPACE_RULES","HIPHEN_SPACE_RULES","BRAK_KROPKI","DYWIZ","CUDZYSLOW_DRUKARSKI","TYPOGRAFISCHE_AANHALINGSTEKENS","TYPOGRAFISCHE_AANHALINGSTEKENS_2","EINDE_ZIN_ONVERWACHT","BACKTICK","GEDACHTESTREEPJE","OPTIONAL_HYPHEN","COMILLAS_TIPOGRAFICAS","COMETES_TIPOGRAFIQUES","GL_SMART_QUOTES"],fe=["OXFORD_SPELLING_Z_NOT_S"],Ne="jeremy",Se=[{ruleId:"FALSCHES_ANFUEHRUNGSZEICHEN",suggestions:[{match:/[\u201e\u201c]/,message:"Alle <lt-em>\u201c</lt-em>\u2026<lt-em>\u201d</lt-em> zu <lt-em>\u201e</lt-em>\u2026<lt-em>\u201c</lt-em> \xe4ndern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN",suggestions:[{match:/[\u201e\u201c]/,message:"Alle <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> zu <lt-em>\u201e</lt-em>\u2026<lt-em>\u201c</lt-em> \xe4ndern"},{match:/(^\xbb)|(\xab$)/,message:"Alle <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> zu <lt-em>\xbb</lt-em>\u2026<lt-em>\xab</lt-em> \xe4ndern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH",suggestions:[{match:/[\u201e\u201c]/,message:"Alle <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> zu <lt-em>\u201e</lt-em>\u2026<lt-em>\u201c</lt-em> \xe4ndern"},{match:/(^\xab)|(\xbb$)/,message:"Alle <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> zu <lt-em>\xab</lt-em>\u2026<lt-em>\xbb</lt-em> \xe4ndern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2",suggestions:[{match:/[\u201a\u2018]/,message:"Alle <lt-em>'</lt-em>\u2026<lt-em>'</lt-em> zu <lt-em>\u201a</lt-em>\u2026<lt-em>\u2018</lt-em> \xe4ndern"},{match:/[\u201e\u201c]/,message:"Alle <lt-em>'</lt-em>\u2026<lt-em>'</lt-em> zu <lt-em>\u201e</lt-em>\u2026<lt-em>\u201c</lt-em> \xe4ndern"}]},{ruleId:"TYPOGRAFISCHE_APOSTROPHE",suggestions:[{match:/\u2019/,message:"Alle Apostrophe zu <lt-em>\u2019</lt-em> \xe4ndern"}]},{ruleId:"EN_QUOTES",suggestions:[{match:/[\u201c\u201d]/,message:"Change all <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> to <lt-em>\u201c</lt-em>\u2026<lt-em>\u201d</lt-em>"}]},{ruleId:"WRONG_APOSTROPHE",suggestions:[{match:/'/,message:"Use <lt-em>'</lt-em> for all bad apostrophes"},{match:/\u2019/,message:"Use <lt-em>\u2019</lt-em> for all bad apostrophes"}]},{ruleId:"PARAGRAF_LEERZEICHEN",suggestions:[{match:/\xa7\u00A0/,message:"Alle Leerzeichen nach <lt-em>\xa7</lt-em> \xe4ndern"}]},{ruleId:"CONSISTENCYRULE_JE_F",suggestions:[{match:/[^e]$/,message:"Remplacer tous les <lt-em>je</lt-em> vers le masculin"}]},{ruleId:"CONSISTENCYRULE_JE_M",suggestions:[{match:/e$/,message:"Remplacer tous les <lt-em>je</lt-em> vers le f\xe9minin"}]},{ruleId:"COMILLAS_TIPOGRAFICAS",suggestions:[{match:/[\u201c\u201d]/,message:"Cambiar todas las <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> por <lt-em>\u201c</lt-em>\u2026<lt-em>\u201d</lt-em>"},{match:/(^\xab)|(\xbb$)/,message:"Cambiar todas las <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> por <lt-em>\xab</lt-em>\u2026<lt-em>\xbb</lt-em>"}]},{ruleId:"COMETES_TIPOGRAFIQUES",suggestions:[{match:/[\u201c\u201d]/,message:"Canvia totes les <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> per <lt-em>\u201c</lt-em>\u2026<lt-em>\u201d</lt-em>"},{match:/(^\xab)|(\xbb$)/,message:"Canvia totes les <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> per <lt-em>\xab</lt-em>\u2026<lt-em>\xbb</lt-em>"}]},{ruleId:"TYPOGRAFISCHE_AANHALINGSTEKENS",suggestions:[{match:/[\u201e\u201c]/,message:"Alle <lt-em>&quot;</lt-em>\u2026<lt-em>&quot;</lt-em> veranderen in <lt-em>\u201e</lt-em>\u2026<lt-em>\u201c</lt-em>"}]},{ruleId:"PT_SMART_QUOTES",suggestions:[{match:/[\u201c\u201d]/,message:"Corrigir todas as aspas."}]},{ruleId:"GL_SMART_QUOTES",suggestions:[{match:/[\u201c\u201d]/,message:"Corrixir todas as comi\xf1as."}]}],Oe=["en","de","es","ca","fr","nl","pt"],Ce=["ar","he","fa","ur","ku","az"],Le=["de","fr"],Pe=3,De=/^[ \u00A0]|[ \u00A0]$/g,Me=/\u202F/g,ve=/[\"\u201c\u201d\u201e]$/,Ue=/^[\"\u201c\u201d\u201e]/,Ge="E_ABORT",be="E_PAYLOAD_TOO_LARGE",xe="E_TIMEOUT",ye="E_GENERIC",He={borderRadiusSmall:4,borderRadiusMedium:8,borderRadiusLarge:12,light:{accentColorDark:"#1976F0",accentColorMedium:"#239AFF",accentColorLight:"#ECF6FF",textColorDark:"#2f3237",textColorMedium:"#5E636E",textColorLight:"#8F96A3",backgroundColorDark:"#DEE3ED",backgroundColorMedium:"#F1F3F9",backgroundColorLight:"#fff",borderColor:"#F1F3F9"},dark:{accentColorDark:"#ECF6FF",accentColorMedium:"#5EB5FF",accentColorLight:"#1976F0",textColorDark:"#f1f3f9",textColorMedium:"#DEE3ED",textColorLight:"#C2C9D6",backgroundColorDark:"#5E636E",backgroundColorMedium:"#2f3237",backgroundColorLight:"#111213",borderColor:"#1D1E20"},fontFamily:{macos:"LanguageTool-mac",win:"LanguageTool-win"},fontSizes:{xSmall:10,small:12,medium:14,large:16,xLarge:18}},Fe="2024-11-19",we="https://languagetool.org/legal/terms",ke="https://languagetool.org/legal/privacy",We="\u2063",Be=`data-${a.get(e.EXTN_PREFIX)}-editor-group`,Xe="standard",Ye="simple",Ze="formal",Ke="fluency",Ve="academic",qe="creative",$e="expand",je="shorten";let ze,Je;try{ze=new RegExp("\\p{L}","u")}catch(e){ze=/[a-z\xe4\xf6\xfc\xdf]/i}function Qe(e){return ze.test(e)}try{Je=new RegExp("(?:\\p{Emoji}|\\u200d|\\ufe0e|\\ufe0f)","u")}catch(e){Je=/_^/}const et=e=>!!e&&Object.getPrototypeOf(e)===Object.prototype,tt=e=>"string"==typeof e;let rt,st,nt,at,it;!function(){const e="\b\t \u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200f\u3000",t=new RegExp("^["+e+"]$"),r=new RegExp("["+e+"]","g");rt=function(e){return" "===e||"\xa0"===e||t.test(e)},st=function(e){return e.replace(r," ")}}(),function(){const e="\u200b\u200c\u200d\xad\u2060\u202a\u202b\u202c\u202d",t=new RegExp("^["+e+"]$"),r=new RegExp("["+e+"]"),s=new RegExp("["+e+"]","g");nt=function(e){return t.test(e)},at=function(e){const t=e.match(r);return t?t.index:-1},it=function(e){return e.replace(s,"")}}();const ot=function(){const e=/^[A-Z\xc8\xc9\xca\xc1\xc0\xc2\xd3\xd2\xd4\xda\xd9\xdb\xcd\xcc\xce\xc4\xdc\xd6]+[A-Z\xc8\xc9\xca\xc1\xc0\xc2\xd3\xd2\xd4\xda\xd9\xdb\xcd\xcc\xce\xc4\xdc\xd6\-!?#@=%().:;<>'\u2019\xb4`"\u201d\u201c*+,\s]+[A-Z\xc8\xc9\xca\xc1\xc0\xc2\xd3\xd2\xd4\xcd\xcc\xce\xc4\xdc\xd6]$/;return function(t){return e.test(t)}}();function Et(e,t){const{start:r,end:s=r}=t||{start:-1};if(!e||-1===r)return;const n=e.map((e=>Array.isArray(e)?e:[e.start,e.end])).findIndex((([e,t])=>r>=e&&s<=t));return n<0?void 0:e[n]}let lt,_t,ut,ct;!function(){const e=/(?:\S+\s+){0,4}\S+$/,t=/^\S+(?:\s+\S+){0,4}/;lt=(e,t,r=t,s=!0)=>{const[n,a]=(()=>{try{const e=s?"":["\\p{Emoji}","\\u200d","\\ufe0e","\\ufe0f"].join("");return[new RegExp("^\\s*(-?[\\p{L}"+e+"]+){0,3}-?\\s*$","u"),new RegExp("^\\s*[\\p{L}"+e+"]+(-[\\p{L}"+e+"]+){0,3}\\s*$","u")]}catch(e){return[/^\s*(-?[a-z\xe4\xf6\xfc\xdf]+){0,3}-?\s*$/i,/^\s*[a-z\xe4\xf6\xfc\xdf]+(-[a-z\xe4\xf6\xfc\xdf]+){0,3}\s*$/i]}})(),i=e=>{return!s&&(t=e,Je.test(t));var t},o=e.substring(t,r),[{length:E=0}]=o.match(/^[^\S]*/),[{length:l=0}]=o.match(/[^\S]*$/);if(!n.test(o))return null;const _=(()=>{const r=t+E,s=e.substring(0,r).split(/[^\S]+/);return It(s[s.length-1]).reverse()})(),u=(()=>{const t=r-l,[s]=e.substring(t).split(/[^\S]+/);return It(s)})(),c=Math.max(_.length,u.length);let g=!1,R=!1,d=t,h=r;for(let e=0;e<c;e++){const t=_[e],r=t&&(Qe(t)||i(t)||"-"===t),s=u[e],n=s&&(Qe(s)||i(s)||"-"===s);if(r&&!g?d-=t.length:g=!0,n&&!R?h+=s.length:R=!0,g&&R)break}E>0&&(d+=E),l>0&&(h-=l);const A=e.substring(d,h);return a.test(A)?{start:d,end:h}:null},_t=(r,s,n=s,a,i=!0)=>{const o=lt(r,s,n,i);if(!o)return null;const E=Et(a,{start:s,end:n});let l="",_="",u="";if(E)u=r.substring(E.start,E.end).trim(),l=r.slice(E.start,o.start).trim(),_=r.slice(o.end,E.end).trim();else{const s=e.exec(r.substring(0,o.start).trim());l=s?s[0]:"",l=l.replace(/^.+\n\n/,"");const n=t.exec(r.substring(o.end).trim());_=n?n[0]:"",_=_.replace(/\n\n.+/,"")}return{word:r.substring(o.start,o.end),position:o,sentence:u,beforeText:l,afterText:_}}}(),function(){let e;const t=[['"','"'],["'","'"],["\u201c","\u201d"],["\u201e","\u201c"],["\u2018","\u2019"],["\u201a","\u2018"],["\xab","\xbb"],["\xbb","\xab"],["`","`"],["\xb4","\xb4"],["{","}"],["[","]"],["(",")"],["<",">"]],r="[^\\S]",s="[.,:;\xa1!\xbf?]",n="[\\udc00-\\udfff\\ud800-\\udb7f\\u200d\\ufe0e\\ufe0f\\p{Emoji_Presentation}\\p{Emoji_Modifier}\\p{Emoji}]";let a,i,o;const E=/(?:\S+\s+){0,4}\S+$/,l=/^\S+(?:\s+\S+){0,4}/;try{const t=[r,s,n].join("|");a=new RegExp(`(?:${t})`,"u"),i=new RegExp(`^(?:${t})*`,"u"),o=new RegExp(`(?:${t})*$`,"u"),e=new RegExp("^\\s*\\p{L}+(-\\p{L}+)*\\s*$","u")}catch(t){const n=[r,s].join("|");a=new RegExp(`(?:${n})`),i=new RegExp(`^(?:${n})*`),o=new RegExp(`(?:${n})*$`),e=/^\s*[a-z\xe4\xf6\xfc\xdf]+(-[a-z\xe4\xf6\xfc\xdf]+)*\s*$/i}ut=(s,n,E=n,l)=>{var _,u;const c=s.substring(n,E),[g=""]=c.match(i),[R=""]=c.match(o),d=g.length,h=R.length,A=[g.trim(),R.trim()];if(c.split(new RegExp(`${r}+`)).length>5)return null;const T=(null===(_=function(e,t){const{start:r}=t||{start:-1};if(!e||-1===r)return;const s=e.sort(((e,t)=>e.start-t.start)).find((e=>{if(r<=e.end&&r>=e.start)return!0}));return s||void 0}(l,{start:n,end:E}))||void 0===_?void 0:_.start)||0,p=(null===(u=function(e,t){const{end:r}=t||{end:-1};if(!e||void 0===r||-1===r)return;const s=e.sort(((e,t)=>e.start-t.start)).find((e=>{if(r<=e.end&&r>=e.start)return!0}));return s||void 0}(l,{start:n,end:E}))||void 0===u?void 0:u.end)||s.length-1;let I=n+d;for(;I>T;){const[e]=s[I-1].match(a)||[];if(e){0===d&&(A[0]+=e.trim());break}I--}let m=E-1-h;for(;m<p-1;){const[e]=s[m+1].match(a)||[];if(e){0===h&&(A[1]+=s[m+1].trim());break}m++}if(m+=1,I===T&&m===p)return null;const f=s.substring(I,m);if(f.split(e).length>=6)return null;let N=!1,S=!1;for(const[e,r]of t){N||!f.startsWith(e)||f.slice(1).includes(r)||(I+=1,N=!0,A[0]+=f[0]);const t=f.length-1;S||!f.endsWith(r)||f.slice(0,t).includes(e)||(m-=1,S=!0,A[1]+=f[t])}return{start:I,end:m,omittedCharacters:A}},ct=(e,t,r=t,s)=>{var n;let a=ut(e,t,r,s);if(!a)return null;const i=Et(s,{start:t,end:r});a=(()=>{if(!i)return a;const t=e.slice(i.start,a.start),r=e.slice(a.end,i.end),s=!t||!!t.match(/^[\xa1\xbf]+$/),n=!r||!!r.match(/^[.!?]+$/);return s&&n&&(a={start:i.start,end:i.end,omittedCharacters:["",""]}),a})();let o="",_="",u="";if(i)u=e.substring(i.start,i.end).trim(),o=e.slice(i.start,a.start).trim(),_=e.slice(a.end,i.end).trim();else{const t=E.exec(e.substring(0,a.start).trim());o=t?t[0]:"",o=o.replace(/^.+\n\n/,"");const r=l.exec(e.substring(a.end).trim());_=r?r[0]:"",_=_.replace(/\n\n.+/,"")}return null===(n=ct.trackOmittedCharacters)||void 0===n||n.call(ct,a.omittedCharacters),{phrase:e.substring(a.start,a.end),position:{start:a.start,end:a.end},sentence:u,beforeText:o,afterText:_}}}();const gt=e=>{const t=We.charCodeAt(0).toString(16),r=new RegExp(`^(?:[^\\S]|\u2022|\\u${t})+$`),s=new RegExp(`^(?:[^\\S]|\\u${t})+$`),n=e.split("").reverse().join(""),a=Math.floor(e.length/2);let i,o,E=0,l=0;for(let t=0;t<a;t++){const a=e.charAt(t),_=n.charAt(t);if(!0!==i&&a.match(r)?(E+=1,i=!1):i=!0,!0!==o&&_.match(s)?(l+=1,o=!1):o=!0,i&&o)break}return[E,l]};function Rt(e,t){if(e===t)return null;let r=0;const s=Math.max(e.length,t.length);for(r=0;r<s&&e[r]===t[r];r++);let n=0;const a=Math.min(e.length,t.length);for(;r+n<a;){if(e[e.length-n-1]!==t[t.length-n-1])break;n++}return{from:r,oldFragment:e.substring(r,e.length-n),newFragment:t.substring(r,t.length-n)}}function dt(e,t,r=!1){const s=[];r&&(e=Ot(e),t=Ot(t));const n=e.split("\n"),a=t.split("\n");let i=0;const o=Math.max(n.length,a.length);for(i=0;i<o&&n[i]===a[i];i++);let E=0;const l=Math.min(n.length,a.length);for(;i+E<l;){if(n[n.length-E-1]!==a[a.length-E-1])break;E++}let _=0;for(let e=0;e<i;e++)_+=n[e].length+1;let u=_;for(let e=i;e<o-E;e++){const t=e<n.length-E?n[e]:null,r=e<a.length-E?a[e]:null;t===r&&_===u||s.push({oldText:t,newText:r,oldOffset:_,newOffset:u,textDiff:Rt(t||"",r||"")}),null!==t&&(_+=t.length+1),null!==r&&(u+=r.length+1)}if(_!==u)for(let e=E-1;e>=0;e--){const t=n[n.length-e-1],r=a[a.length-e-1];s.push({oldText:t,newText:r,oldOffset:_,newOffset:u,textDiff:null}),_+=t.length+1,u+=r.length+1}return s}function ht(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/\//g,"&#x2F;")}function At(e,t){let r=0,s=e.length-1;for(;r<=s;){const n=r+Math.ceil((s-r)/2),a=t(e[n]);if(a>0)r=n+1;else{if(!(a<0)){for(let r=n;r>0;r--)if(0!==t(e[r-1]))return e[r];return e[0]}s=n-1}}return null}function Tt(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);const t=Array.isArray(e)?[]:{};for(const r in e)t[r]=Tt(e[r]);return t}let pt=null;function It(e){return Intl.Segmenter?(pt||(pt=new Intl.Segmenter(void 0,{granularity:"grapheme"})),Array.from(pt.segment(e),(e=>e.segment))):[...e]}var mt;!function(e){e.GC="GC",e.GC_RECOMMENDATION="GC_RECOMMENDATION",e.REPHRASING="PPHR"}(mt||(mt={}));const ft=function(){const e=/^\w+\.$/;return(t,r)=>{if(!t.isSpellingError)return!1;let s=t.originalPhrase;if(e.test(s)&&(s=s.substring(0,s.length-1)),r.includes(s))return!0;if(function(e){const t=e.charAt(0);return t===t.toUpperCase()&&t!==t.toLowerCase()}(s)){const e=(n=s).charAt(0).toLowerCase()+n.substr(1);if(r.includes(e))return!0}var n;return!1}}();!function(){const e=/[\u0300-\u036f]/g,t=/\u0142/g,r=/\u00F8/g}();function Nt(e,t,r,s,n=!1){return n?e<=s&&t>=r:e<s&&t>r}function St(e,t,r,s=!1){if(s){if(t<=e&&e<r)return 0}else if(t<=e&&e<=r)return 0;return e-t}const Ot=e=>st(e).replace(/[\u00A0]/g," ").normalize();class Ct{static getServerBaseUrl(e,t=!1,r=!0){const s=r&&(t?this._useFallbackServerForParagraphLevelRequests:this._useFallbackServerForTextLevelRequests)&&!e.apiServerUrl;return e.apiServerUrl&&!this._isLanguageToolServer(e.apiServerUrl)?e.apiServerUrl:e.isPremium||e.user||e.apiServerUrl===P?s?D:P:s?L:C}static _getServerFullUrl(e,t=!1,r=!1){const s=this.getServerBaseUrl(e,t),n=s.endsWith("/")?"":"/",a=new URL(s+n+"check");return a.searchParams.set("c","1"),t&&!1===e.useParagraphLevelCaching||a.searchParams.set("instanceId",e.instanceId),r&&a.searchParams.set("languageChanged","true"),e.version&&a.searchParams.set("v",e.version),a.toString()}static _abortTextLevelCheckRequest(e){this._textLevelAbortControllers.has(e)&&(this._textLevelAbortControllers.get(e).abort(),this._textLevelAbortControllers.delete(e))}static _abortParagraphLevelCheckRequest(e){this._paragraphLevelAbortControllers.has(e)&&(this._paragraphLevelAbortControllers.get(e).abort(),this._paragraphLevelAbortControllers.delete(e))}static _abortLanguageDetectionRequest(e){this._languageDetectionAbortControllers.has(e)&&(this._languageDetectionAbortControllers.get(e).abort(),this._languageDetectionAbortControllers.delete(e))}static _abortRecommendationRequest(e){const t=this._recommendationAbortControllers.get(e);t&&(t.abort(),this._recommendationAbortControllers.delete(e))}static _prepareText(e){return e.replace(this.ZWNJ_REGEXP,this.ZWS)}static _joinInChunks(e,t=j){const r=[];let s=0,n=[];return e.forEach((e=>{s>t&&(s=0,n=[]),n.push(e),s+=e.text.length,r.includes(n)||r.push(n)})),r}static _getRequestData(e,t,r){const s=new URLSearchParams,n={text:e};r.recipientInfo&&(r.recipientInfo.address||r.recipientInfo.fullName)&&(n.metaData={EmailToAddress:r.recipientInfo.address,FullName:r.recipientInfo.fullName}),s.append("data",JSON.stringify(n));const a=Boolean(r.isPremium||!r.apiServerUrl||r.apiServerUrl&&r.apiServerUrl.startsWith(P)||r.apiServerUrl&&!this._isLanguageToolServer(r.apiServerUrl));if(a&&r.user&&"password"in r.user?(s.append("username",r.user.email),s.append("password",r.user.password)):a&&r.user&&"token"in r.user&&(s.append("username",r.user.email),s.append("tokenV2",r.user.token)),s.append("textSessionId",r.instanceId),r.isPremium||s.append("enableHiddenRules","true"),r.motherTongue&&Le.includes(r.motherTongue)&&s.append("motherTongue",r.motherTongue),"normal"!==r.checkLevel&&s.append("level",r.checkLevel.replace("hidden-","")),t)s.append("language",t.code);else{s.append("language","auto"),s.append("noopLanguages",r.preferredLanguages.join(","));const e=this._getPreferredVariants(r.languageVariants);e.length>0&&s.append("preferredVariants",e.toString())}if(r.testGroups){const e=[];for(const[t,s]of Object.entries(r.testGroups))s&&e.push(t);e.length&&s.append("abtest",e.join(","))}if(s.append("preferredLanguages",r.preferredLanguages.join(",")),r.forcePreferredLanguages&&s.append("forcePreferredLanguages","true"),r.writingGoalId){const e=this.HIGH_LEVEL_GOALS.find((e=>e.id===r.writingGoalId));e&&s.append("toneTags",e.tags.join(","))}const i=["WHITESPACE_RULE"].concat(r.disabledRules.filter((e=>fe.includes(e))));return s.append("disabledRules",i.join(",")),r.userAgent&&s.append("useragent",r.userAgent),s}static _getPreferredVariants(e){return Object.values(e)}static _getTextLevelRequestData(e,t,r){const s=this._getRequestData(e,t,r);return s.append("mode","textLevelOnly"),s}static _getParagraphLevelCheckRequestData(e,t,r,s){const n=this._getRequestData(e,t,r);return n.append("mode","allButTextLevelOnly"),n.append("allowIncompleteResults",String(s)),n}static async _sendRequest(e,t,r=A){const s=fetch(e,t).catch((t=>{throw"AbortError"===t.name?{reason:"AbortError",status:0,response:t.message||""}:{reason:"ConnectionError",status:0,url:e.replace(/\?.*/,""),response:t.message||""}})).then(this._checkForException).then((e=>e.json())),n=new Promise(((t,s)=>{setTimeout((()=>{s({reason:"TimeoutError",status:0,url:e.replace(/\?.*/,""),response:""})}),r)}));return Promise.race([s,n])}static _isConnectionOrServerIssue(e){return w.includes(e.status)||["ConnectionError","TimeoutError"].includes(e.reason)}static _getGraphemesCount(e,t,r=0){for(let s=r;s<e.length;s++){if(t<=0)return s-r;t-=e[s].length}return e.length-r}static _getCodepointsCount(e,t,r=0){let s=0;for(let n=r;n<Math.min(e.length,r+t);n++)s+=e[n].length;return s}static _correctMatches(e,t,r){if(t!==r){const s=It(t),n=It(r);for(const t of e){const e=Ct._getGraphemesCount(s,t.offset),r=Ct._getGraphemesCount(s,t.length,e);t.offset=Ct._getCodepointsCount(n,e),t.length=Ct._getCodepointsCount(n,r,e)}}return e}static _getLeftText(e,t,r,s=15){let n=Math.max(t-s,0);if(r){const r=e.lastIndexOf("\n",t);r>=n&&(n=r+1)}let a=e.substring(n,t).replace(this.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP,"");return 0===n||r&&"\n"===e[n-1]||(a="..."+a),a}static _getRightText(e,t,r,s=15){let n=Math.min(t+s,e.length);if(r){const r=e.indexOf("\n",t);-1!==r&&r<=n&&(n=r)}let a=e.substring(t,n).replace(this.NON_ALPHANUMERIC_AT_END_REGEXP,"");return n===e.length||r&&"\n"===e[n]||(a+="..."),a}static _transformMatches(e,t,r,s=!1){return e.map((e=>{const n=e.rule.id.startsWith("DB_"),a=this.SPELLING_RULES_ID.some((t=>e.rule.id.includes(t))),i=this.STYLE_ISSUE_TYPES.some((t=>e.rule.issueType===t)),o="typographical"===e.rule.issueType&&"CASING"!==e.rule.category.id||"PUNCTUATION"===e.rule.category.id||"TYPOGRAPHY"===e.rule.category.id||e.rule.category.id.includes("KOMMA"),E=Boolean(e.rule.tags&&e.rule.tags.includes("picky")),l="RECOMMENDATION"===e.rule.issueType||"PHRASAL_RECOMMENDATION"===e.rule.issueType,_=t.substr(e.offset,e.length),u=`${Ct._getLeftText(t,e.offset,s)}|${_}|${Ct._getRightText(t,e.offset+e.length,s)}`,c=Ct._getLeftText(t,e.offset,!0,60),g=Ct._getRightText(t,e.offset+e.length,!0,60),R=`${ht(c)}<lt-em>${ht(_)}</lt-em>${ht(g)}`;let d="";e.shortMessage&&e.shortMessage.length<60&&e.shortMessage!==e.message&&(d=e.shortMessage.replace(this.PUNCTUATION_AT_END,""));const h=e.replacements.map((e=>({value:e.value,prefix:e.prefix,suffix:e.suffix,type:e.type,shortDescription:e.shortDescription})));return{isParagraphLevelCheck:s,rule:e.rule,isCustomError:n,isSpellingError:a,isStyleError:i,isPunctuationError:o,isPicky:E,isRecommendation:l,contextForSureMatch:e.contextForSureMatch,language:{code:r.code,name:r.name},description:e.message,shortDescription:d,goodExample:e.goodExample,badExample:e.badExample,start:e.offset,end:e.offset+e.length,length:e.length,originalPhrase:_,contextPhrase:u,longContextPhrase:R,fixes:h,isLocked:e.isLocked}}))}static _adjustErrors(e,t,r){const s=r.recipientInfo?r.recipientInfo.fullName.split(" ").filter((e=>e)):[];return e.filter((e=>{e.fixes=e.fixes.filter((t=>t.value!=="("+e.originalPhrase+")"&&t.value!==e.originalPhrase&&"(suggestion limit reached)"!==t.value&&"(se ha alcanzado el l\xedmite de sugerencias)"!==t.value&&"(Vorschlagslimit erreicht)"!==t.value)),e.language.code.startsWith("en")&&ot(e.originalPhrase)&&!/[a-z]/i.test(e.contextPhrase)&&e.fixes.forEach((t=>{t.value.toLowerCase()!==e.originalPhrase.toLowerCase()&&(t.value=t.value.toUpperCase())})),"PT_CLICHE_REPLACE"!==e.rule.id&&"PT_WORDINESS_REPLACE"!==e.rule.id||e.fixes.forEach((t=>{(t.value.startsWith("REFORMULAR")||t.value.startsWith("APAGAR")||t.value.startsWith("ESPECIFICAR"))&&(e.description=e.description.replace(/\s\xc9 prefer\xedvel dizer.+(REFORMULAR|APAGAR|ESPECIFICAR).+$/,""),t.value="")}));if(this.EMAIL_SIGNATURE_SEPARATOR_REGEXP.test(e.originalPhrase))return!1;if(this.INVISIBLE_PHRASE_REGEXP.test(e.originalPhrase))return!1;if(e.rule.id.endsWith("WORD_REPEAT_BEGINNING_RULE")&&this.ONLY_NUMBERS_REGEXP.test(e.originalPhrase))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.COLON_WHITESPACE_REGEXP.test(e.originalPhrase))return!1;const n=t.substring(e.start-25,e.start),a=t.substr(e.end,25);if(r.ignoreCapitalizationErrorsAtLineStart&&"UPPERCASE_SENTENCE_START"===e.rule.id&&this.PREVENT_MID_SENTENCE_CAPITALIZATION.test(n))return!1;if(r.ignoreCapitalizationErrorsAtLineStart&&"PUNCTUATION_PARAGRAPH_END"===e.rule.id&&this.PREVENT_MID_SENTENCE_PUNCTUATION.test(a))return!1;if("DE_CASE"===e.rule.id&&this.BULLET_POINT_REGEXP.test(n))return!1;if("DE_CASE"===e.rule.id&&this.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP.test(n))return!1;if("DE_CASE"===e.rule.id&&this.PIPE_AT_END_REGEXP.test(n))return!1;if("DE_CASE"===e.rule.id&&this.MARKDOWN_HEADLINE_REGEXP.test(n))return!1;if("DE_CASE"===e.rule.id&&this.EMOJI_SENTENCE_START_REGEXP.test(n))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP.test(a))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.WIKI_MARKUP_AT_END_REGEXP.test(n))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.ONE_LETTER_AT_END_REGEXP.test(n))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.NUMBER_WITH_DOT_AT_END_REGEXP.test(n))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&n.endsWith("{!"))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&this.SINGLE_UPPERCASE_LETTER_REGEXP.test(e.originalPhrase)&&this.ABBREVIATION_AT_END_REGEXP.test(n))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&"net"===e.originalPhrase.toLowerCase())return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&this.NET_AT_BEGINNING_REGEXP.test(a))return!1;if(e.rule.id.startsWith("AI_")&&1===e.fixes.length&&e.originalPhrase.replace(this.INVISIBLE_CHARS_REGEXP,"")===e.fixes[0].value)return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(")")&&n.endsWith(this.ZWS))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(".")&&this.FILE_TYPE_AT_BEGINNING_REGEXP.test(a))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&n.endsWith("(")&&(",)"===e.originalPhrase||".)"===e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&n.endsWith("\n")&&[")","}","]","."].includes(e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&a.startsWith("/"))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("WORT1_BINDESTRICH_SPACE_WORT2"===e.rule.id&&e.originalPhrase.endsWith(this.ZWS))return!1;if("MULTIPLICATION_SIGN"===e.rule.id&&(this.AT_LEAST_TWO_LETTERS_AT_END_REGEXP.test(n)||!a||this.PUNCTUATION_AT_BEGINNING_REGEXP.test(a)))return!1;if("ZBEDNA_SPACJA_PRZED"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("UNLIKELY_OPENING_PUNCTUATION"===e.rule.id&&this.PUNCTUATION_SPACE_AT_END_REGEXP.test(n))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(!this.LOWERCASE_REGEXP.test(e.originalPhrase)||e.originalPhrase.includes("-")||e.originalPhrase.includes("__")||this.SLASH_AT_END_REGEXP.test(n)||this.SLASH_AT_BEGINNING_REGEXP.test(a)))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&n.endsWith("[")&&a.startsWith("]"))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&ve.test(n)&&Ue.test(a))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(n.endsWith("=")||n.endsWith("&")||n.endsWith("?")))return!1;if(["APOS_INCORRECT","LOOSE_ACCENTS"].includes(e.rule.id)&&"`"===e.originalPhrase)return!1;if(["_2_AANH_B","FALSCHES_ANFUEHRUNGSZEICHEN_2"].includes(e.rule.id)&&"``"===e.originalPhrase)return!1;if("DASH_RULE"===e.rule.id&&a.startsWith(" [")&&(!n||n.endsWith("\n")))return!1;if(e.isSpellingError&&e.originalPhrase.length>6&&e.fixes.length>4&&e.language.code.startsWith("de")&&(e.fixes.length=4),e.isSpellingError||"WORD_CONTAINS_UNDERSCORE"===e.rule.id){const t=e.originalPhrase.charAt(0),i=e.originalPhrase.toLowerCase();if(ft(e,r.dictionary))return!1;if((a.startsWith("_")||n.endsWith("_"))&&!e.language.code.startsWith("de"))return!1;if(e.originalPhrase.startsWith("$")&&a.startsWith("}")&&n.endsWith("{"))return!1;if(e.originalPhrase.startsWith("$")&&e.originalPhrase.endsWith("$"))return!1;if(this.HTML_ENTITIES.includes(e.originalPhrase)&&n.endsWith("&")||this.HTML_ENTITIES_WITH_AND.includes(e.originalPhrase)||this.HTML_ENTITIES_WITH_AND.includes("&"+e.originalPhrase))return!1;if(this.COMMON_TLDS.some(((e,t)=>i.endsWith("."+e)||this.COMMON_TLD_WITH_DOT_REGEXPS[t].test(a))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(n)&&this.COMMON_TLDS.includes(i))return!1;if(this.COMMON_FILE_TYPES.some(((e,t)=>i.endsWith("."+e)||this.COMMON_FILE_TYPE_WITH_DOT_REGEXPS[t].test(a))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(n)&&this.COMMON_FILE_TYPES.includes(i))return!1;const o="@"===t||this.MENTION_SYMBOL_AT_BEGINNING_REGEXP.test(n),E="#"===t||this.HASH_SYMBOL_AT_BEGINNING_REGEXP.test(n);if(o||E)return!1;if(s.some((t=>t===e.originalPhrase)))return!1;if(this.WAVY_DASH_REGEXP.test(e.originalPhrase))return!1;for(const t of s)if(t.toLowerCase()===e.originalPhrase.toLowerCase()&&!e.fixes.some((e=>e.value===t))){e.fixes.unshift({value:t});break}}return!0}))}static _processResponse(t,r,s,n,i,o=!1,E=!1,l=!1){t.matches=this._correctMatches(t.matches,s,n);let _=this._transformMatches(t.matches,n,t.language,o);_=this._adjustErrors(_,n,i);let u=[];const c=[],g=[],R=!i.apiServerUrl||this._isLanguageToolServer(i.apiServerUrl);if(r=this._correctMatches(r.filter((({start:e,end:t})=>t-e>-1)).map((({start:e,end:t,detectedLanguages:r,checkStatus:s})=>({offset:e,length:t-e,detectedLanguages:r,checkStatus:s}))),s,n).map((({offset:e,length:t,detectedLanguages:r,checkStatus:s})=>({start:e,end:e+t,length:t,detectedLanguages:r,checkStatus:s}))),E)return{errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],sentenceRanges:r};if(l){const t=a.get(e.FIX_ALL_CONFIG);return{errors:_.filter((e=>!(!e.isRecommendation||t.FIX_RECOMMENDATIONS)||(!(!e.isStyleError||t.FIX_STYLE_ERRORS)||!t.FIX_GC_ERRORS))),premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],sentenceRanges:r}}return!i.isPremium&&R&&t.language&&t.language.code.startsWith("nl")&&(_=_.filter((e=>!this.NL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],u.push(e),!1)))),!i.isPremium&&R&&t.language&&t.language.code.startsWith("pl")&&(_=_.filter((e=>!this.PL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],u.push(e),!1)))),i.isPremium&&_.forEach((e=>{this.NL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0),this.PL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0)})),i.debug&&_.forEach((e=>{e.description=(e.rule.isPremium?"prem:":"")+e.rule.id+"["+(e.rule.subId||"")+"] "+e.description})),t.hiddenMatches&&(u=u.concat(this._transformMatches(t.hiddenMatches,n,t.language,o))),"hidden-picky"===i.checkLevel&&(_=_.filter((e=>!e.isPicky||(g.push(e),!1))),t.hiddenMatches&&(u=u.filter((e=>!e.isPicky||(c.push(e),!1))))),{errors:_,premiumErrors:u,pickyErrors:g,premiumPickyErrors:c,sentenceRanges:r}}static _correctErrorOffsets(e,t){const r=[];let s=0;for(const i of e){const e=i.text.length;for(const o of t)if(o.start>=s&&o.end<=s+e){var n,a;const e=Object.assign({},o);e.start=e.start-s+i.offset,e.end=e.start+e.length,null===(a=e.rule)||void 0===a||null===(n=a.phraseDiff)||void 0===n||n.forEach((e=>{e.sourceStart=e.sourceStart-s+i.offset,e.sourceEnd=e.sourceEnd-s+i.offset,e.targetEnd=e.targetEnd-s+i.offset,e.targetStart=e.targetStart-s+i.offset})),r.push(e)}s+=e+2}return r}static async checkTextLevel(e,t,r,s=!1){e=this._prepareText(e);const n=Boolean(r.adapter);if(!e.trim()||n)return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortTextLevelCheckRequest(r.instanceId),this._textLevelAbortControllers.set(r.instanceId,new AbortController),this._useFallbackServerForTextLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=k&&(this._useFallbackServerForTextLevelRequests=!1);const a=e.normalize(),i=this._getServerFullUrl(r,!1,s),o={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(a,t,r),signal:this._textLevelAbortControllers.get(r.instanceId).signal};return this._sendRequest(i,o).then((t=>{const{errors:s,premiumErrors:n,pickyErrors:i,premiumPickyErrors:o}=this._processResponse(t,[],a,e,r);return{language:{code:t.language.code,name:t.language.name,detectedLanguage:t.language.detectedLanguage},errors:s,premiumErrors:n,pickyErrors:i,premiumPickyErrors:o}})).catch((s=>{if(this._isConnectionOrServerIssue(s)){this._abortTextLevelCheckRequest(r.instanceId);if(!r.apiServerUrl&&!this._useFallbackServerForTextLevelRequests)return this._useFallbackServerForTextLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkTextLevel(e,t,r)}throw s}))}static _buildSentenceRanges(e,t){if(!t.extendedSentenceRanges&&!t.sentenceRanges)return[];let r=t.extendedSentenceRanges;r||(r=(t.sentenceRanges||[]).map((e=>({from:e[0],to:e[1],detectedLanguages:[{language:t.language.code.split("-")[0],rate:1}]}))));return((e,t)=>{const r=new RegExp(We,"g"),s=[];for(const n of e){const{start:e,end:a}=n,i=t.substring(e,a);if(!i.replace(r,"").trim())continue;const[o,E]=gt(i),l=e+o,_=l+i.length-o-E,u=_-l;s.push({start:l,end:_,length:u,detectedLanguages:n.detectedLanguages,checkStatus:n.checkStatus})}return s})(r.map((e=>({start:e.from,end:e.to,length:e.to-e.from,detectedLanguages:e.detectedLanguages.map((e=>({language:e.language,confidence:e.rate}))),checkStatus:e.checkStatus}))),e)}static cancelAllRequests(e){this._abortParagraphLevelCheckRequest(e),this._abortLanguageDetectionRequest(e),this._abortTextLevelCheckRequest(e),this._abortRecommendationRequest(e)}static async checkParagraphLevel(t,r,s,n=!1,i,o,E,l){t.forEach((e=>{e.text=this._prepareText(e.text)}));if(!t.some((e=>!!e.text.trim())))return{language:r,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],isIncompleteResult:!1,areErrorsSuppressed:!1};this._abortParagraphLevelCheckRequest(s.instanceId),this._paragraphLevelAbortControllers.set(s.instanceId,new AbortController),this._useFallbackServerForParagraphLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=k&&(this._useFallbackServerForParagraphLevelRequests=!1);let _=!1;if(E&&E.ruleId){const t=a.get(e.AI_RULE_ID_REGEX);_=t.test(E.ruleId)}const u=this._getServerFullUrl(s,!0),c=this._joinInChunks(t),g=[];for(const e of c){var R;const t=e.map((e=>e.text)).join("\n\n"),a=t.normalize(),c={method:"post",mode:"cors",credentials:"omit",body:this._getParagraphLevelCheckRequestData(a,r,s,n),signal:this._paragraphLevelAbortControllers.get(s.instanceId).signal},d=r=>{var n;const i=this._postProcessParagraphLevelCheckResult(r,e,a,t,s,_,o,l);null===(n=s.recommendationCallback)||void 0===n||n.call(s,i)};let h;h="REPHRASING"===(null==E?void 0:E.ruleId)?mt.REPHRASING:(null==E?void 0:E.isRecommendation)?mt.GC_RECOMMENDATION:mt.GC;const A={input:{acceptChangeType:h,language:null==r?void 0:r.code,paragraphs:e,editorCompleteText:i||"",preferredVariants:this._getPreferredVariants(s.languageVariants),disableRecommendations:s.disableRecommendations,replacementText:null==E?void 0:E.replacementText,hasUserAppliedFix:!!E&&_,changedParagraphsSentencesLength:o,appliedFixAll:l,writingGoal:s.writingGoalId},signal:this._paragraphLevelAbortControllers.get(s.instanceId).signal,recommendationResponseCallback:d,metaData:{instanceId:s.instanceId,tabId:s.tabId,hostUrl:s.hostUrl||"",hostCategory:s.hostCategory}},T=(s.adapter?null===(R=s.adapter)||void 0===R?void 0:R.grammarCheck(A):this._sendRequest(u,c)).then((r=>this._postProcessParagraphLevelCheckResult(r,e,a,t,s,_,o,l)));g.push(T)}return Promise.all(g).then((e=>{const t=e[0].language,r=e[0].areErrorsSuppressed,s=e[0].metaData;return{language:t,errors:Array.prototype.concat.apply([],e.map((e=>e.errors))),premiumErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumErrors))),premiumPickyErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumPickyErrors))),pickyErrors:Array.prototype.concat.apply([],e.map((e=>e.pickyErrors))),isIncompleteResult:e.some((e=>e.isIncompleteResult)),sentenceRanges:Array.prototype.concat.apply([],e.filter((e=>Boolean(e.sentenceRanges))).map((e=>e.sentenceRanges))),areErrorsSuppressed:r,metaData:s}})).catch((e=>{if(this._isConnectionOrServerIssue(e)){this._abortParagraphLevelCheckRequest(s.instanceId);if((!s.apiServerUrl||this._isLanguageToolServer(s.apiServerUrl))&&!this._useFallbackServerForParagraphLevelRequests)return this._useFallbackServerForParagraphLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkParagraphLevel(t,r,s,n,i)}throw e}))}static async checkParagraph(t,r,s,n,i=!1,o,E,l,_){r.text=this._prepareText(r.text);if(!!!r.text.trim())return{language:s,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],isIncompleteResult:!1,areErrorsSuppressed:!1};this._abortParagraphLevelCheckRequest(t),this._paragraphLevelAbortControllers.set(t,new AbortController),this._useFallbackServerForParagraphLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=k&&(this._useFallbackServerForParagraphLevelRequests=!1);let u=!1;if(l&&l.ruleId){const t=a.get(e.AI_RULE_ID_REGEX);u=t.test(l.ruleId)}const c=this._getServerFullUrl(n,!0),g=this._joinInChunks([r]),R=[];for(const e of g){var d;const r=e.map((e=>e.text)).join("\n\n"),a=r.normalize(),g={method:"post",mode:"cors",credentials:"omit",body:this._getParagraphLevelCheckRequestData(a,s,n,i),signal:this._paragraphLevelAbortControllers.get(t).signal},h=t=>{var s;const i=this._postProcessParagraphLevelCheckResult(t,e,a,r,n,u,E,_);null===(s=n.recommendationCallback)||void 0===s||s.call(n,i)};let A;A="REPHRASING"===(null==l?void 0:l.ruleId)?mt.REPHRASING:(null==l?void 0:l.isRecommendation)?mt.GC_RECOMMENDATION:mt.GC;const T={input:{acceptChangeType:A,language:null==s?void 0:s.code,paragraphs:e,editorCompleteText:o||"",preferredVariants:this._getPreferredVariants(n.languageVariants),disableRecommendations:n.disableRecommendations,replacementText:null==l?void 0:l.replacementText,hasUserAppliedFix:!!l&&u,changedParagraphsSentencesLength:E,appliedFixAll:_,writingGoal:n.writingGoalId},signal:this._paragraphLevelAbortControllers.get(t).signal,recommendationResponseCallback:h,metaData:{instanceId:t,tabId:n.tabId,hostUrl:n.hostUrl||"",hostCategory:n.hostCategory}},p=(n.adapter?null===(d=n.adapter)||void 0===d?void 0:d.grammarCheck(T):this._sendRequest(c,g)).then((t=>this._postProcessParagraphLevelCheckResult(t,e,a,r,n,u,E,_)));R.push(p)}return Promise.all(R).then((e=>{const t=e[0].language,r=e[0].areErrorsSuppressed,s=e[0].metaData;return{language:t,errors:Array.prototype.concat.apply([],e.map((e=>e.errors))),premiumErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumErrors))),premiumPickyErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumPickyErrors))),pickyErrors:Array.prototype.concat.apply([],e.map((e=>e.pickyErrors))),isIncompleteResult:e.some((e=>e.isIncompleteResult)),sentenceRanges:Array.prototype.concat.apply([],e.filter((e=>Boolean(e.sentenceRanges))).map((e=>e.sentenceRanges))),areErrorsSuppressed:r,metaData:s}})).catch((e=>{throw this._isConnectionOrServerIssue(e)&&this._abortParagraphLevelCheckRequest(t),e}))}static _postProcessParagraphLevelCheckResult(e,t,r,s,n,a,i,o){var E;const{language:l,warnings:_}=e,u=e.ignoreRanges||[];n.debug&&u.length&&(e.matches=this._filterErrorsInIgnoredRanges(e.matches,u),e.hiddenMatches&&(e.hiddenMatches=this._filterErrorsInIgnoredRanges(e.hiddenMatches,u)),this._addIgnoredRangeMatches(r,e.matches,u));let c=this._buildSentenceRanges(r,e);const g=(null===(E=n.adapter)||void 0===E?void 0:E.grammarCheck)?a:a&&1===t.length&&c.length===i,{errors:R,premiumErrors:d,pickyErrors:h,premiumPickyErrors:A,...T}=this._processResponse(e,c,r,s,n,!0,g,o);c=T.sentenceRanges;const p=this._correctErrorOffsets(t,R),I=this._correctErrorOffsets(t,d),m=this._correctErrorOffsets(t,h),f=this._correctErrorOffsets(t,A);return c=this._correctErrorOffsets(t,c),{language:{code:l.code,name:l.name},errors:p,premiumErrors:I,pickyErrors:m,premiumPickyErrors:f,isIncompleteResult:!!_&&_.incompleteResults,areErrorsSuppressed:g,sentenceRanges:c,metaData:null==e?void 0:e.metaData}}static async checkRecommendation(e,t){e.isForcedRecommendation||this._abortRecommendationRequest(e.instanceId);const r=new AbortController;this._recommendationAbortControllers.set(e.instanceId,r);const s={input:{language:e.language.code,texts:e.texts,priorities:e.priorities,writingGoal:e.writingGoal||""},metaData:{...null==t?void 0:t.metaData}};if(null==t?void 0:t.adapter){var n;const a=await t.adapter.recommendation(s,{...t.options,signal:(null===(n=t.options)||void 0===n?void 0:n.signal)||r.signal});return this._transformMatches(a.matches||[],e.originalText,e.language,!0)}return new Promise((e=>{e([])}))}static async unlockRecommendation(e,t){var r;return await(null===(r=t.adapter)||void 0===r?void 0:r.unlockRecommendation({lockId:e,metaData:t.metaData}))}static _filterErrorsInIgnoredRanges(e,t){return e.filter((e=>{const r=e.offset,s=e.offset+e.length;return!t.some((e=>r>=e.from&&r<=e.to||s>=e.from&&s<=e.to))}))}static _addIgnoredRangeMatches(e,t,r){r.forEach((r=>{let s=r.to-r.from;const n=e.substring(r.from,r.to).match(/\s+$/);n&&(s-=n[0].length);const a={offset:r.from,length:s,rule:{id:"IGNORED_RANGE",category:{id:"IGNORED_RANGE",name:"Ignored Range"},issueType:"ignoredRange",description:"",isPremium:!1},contextForSureMatch:0,message:"This text is in a different language than the rest of the text.",shortMessage:"Different language: "+r.language.code,replacements:[]};t.push(a)}))}static async detectLanguage(e,t,r){e=this._prepareText(e);const s=Boolean(r.adapter);if(!e.trim()||t||s)return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortLanguageDetectionRequest(r.instanceId),this._languageDetectionAbortControllers.set(r.instanceId,new AbortController),this._useFallbackServerForLanguageDetection&&Date.now()-this._mainServerUnavailabilityTimeStamp>=k&&(this._useFallbackServerForLanguageDetection=!1);const n=e.substr(0,1e3).normalize(),a=this._getServerFullUrl(r,!1),i={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(n,t,r),signal:this._languageDetectionAbortControllers.get(r.instanceId).signal};return this._sendRequest(a,i).then((e=>({language:{code:e.language.code,name:e.language.name},errors:[],premiumErrors:[],premiumPickyErrors:[],pickyErrors:[]}))).catch((s=>{if(this._isConnectionOrServerIssue(s)){this._abortLanguageDetectionRequest(r.instanceId);if((!r.apiServerUrl||this._isLanguageToolServer(r.apiServerUrl))&&!this._useFallbackServerForLanguageDetection)return this._useFallbackServerForLanguageDetection=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.detectLanguage(e,t,r)}throw s}))}static _isLanguageToolServer(e){return!!e&&(e.includes("api.languagetool.org")||e.includes("languagetool.org/api")||e.includes("api.languagetoolplus.com"))}static checkForPaidSubscription(e,t,r,s=P){return new Promise(((n,a)=>{s+=s.endsWith("/")?"check":"/check";const i=new URLSearchParams;i.append("language","en-us"),i.append("data",JSON.stringify({text:"The languagetool testrule 8634756."})),e&&t?(i.append("username",e),i.append("password",t)):e&&r&&(i.append("username",e),i.append("tokenV2",r));const o={method:"post",mode:"cors",credentials:"omit",body:i};this._sendRequest(s,o).then((e=>{const t=e.matches.some((e=>"PREMIUM_FAKE_RULE"===e.rule.id));n(t)})).catch(a)}))}static addWordToDictionary(e,t){if(Boolean(t.adapter))return;const r=this.getServerBaseUrl(t),s=r.endsWith("/")?"":"/",n=new URL(r+s+"words/add");if(t.user&&"token"in t.user)n.searchParams.set("username",t.user.email),n.searchParams.set("tokenV2",t.user.token);else{if(!t.user||!("password"in t.user))return Promise.reject(new Error("Not logged-in for adding words to dictionary"));n.searchParams.set("username",t.user.email),n.searchParams.set("password",t.user.password)}return n.searchParams.set("word",e.trim()),fetch(n.toString(),{method:"POST"}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`))))}}Ct.NL_PREMIUM_RULES=["FAAG_VAAG","TOO_LONG_SENTENCE","_2_LEESTEKENS","WEEKEND","CASU_QUO","MOMENTEEL","SLECHTS","LEENWOORDEN","KOMMA_HOOR","RELEVANT","HINTS","CHECKEN","ALLEEN_BE","MACHTE","ECHTER","COMMUNICEREN","DESIGN","SANDAAL_ZANDAAL","N","MIDDELS","INTEGREREN","PRIMAIR","OVERIGENS","BETREFFENDE","AGENDA","ERGO","TEN_BEHOEVE","KOMMA_AANH","TM","IE","TER_ZAKE","SIGNIFICANT","GELIEVE","BEHOREN","NAAR_AANLEIDING_VAN","VAN_PLAN_ZIJN","HEDEN","TEN_DODE","VREEMD_VRZ_HIJ","DES","IMPACT","IMMER","BOVENSTAAND","XXXYJE","DUTCH_WRONG_WORD_IN_CONTEXT","LANCEREN","MET_BEHULP_VAN","PRIORITEIT","UWENTWEGE","CATEGORIE","CRITERIUM","GEMOTIVEERD"],Ct.PL_PREMIUM_RULES=["BOWIEM_ZAS","ZE_Z_SPOL","SPACJA_ZNAK_ROWNOSCI","BRAK_PRZECINKA_GDY","PYTANIE_CO","BRAK_PRZECINKA_JESLI","PRZECINEK_ANI","SKROTOWCE_BEZ_DYWIZU","NIEZGODNOSC_PRZYPADKU_PO_LICZEBNIKU","PODMIOT_ORZECZENIE","ROWNIE_JAK","JAK_I","PRZECINEK_POROWNANIE","WOLACZ_BEZ_PRZECINKA","ODNOSNIE_DO","GENERALNIE","BOWIEM_ZAS_PRZECINEK","WYDAWAC_SIE_BYC","POSIADAC_MIEC","PL_GUILLEMET","ITP_ITD","SPACJA_PROCENT","PO","W_TEMACIE","PL_DWA_WYRAZY","W_NAWIAZANIU_DO","WE_W","POKI_CO","VS","DZIEN_DZISIEJSZY","WIELOKROTNE_WYSTPIENIE_TEGO_SAMEGO_WYRAENIA_PRZYIMKOWEGO","I_LUB","PELNIC_ROLE","OKRES_CZASU","UZNAC_JAKO","EFEKT_KONCOWY","DLATEGO_PONIEWAZ","NA_DZIEN_DZISIEJSZY","DODATKOWO_CO_WIECEJ","OWY_W","DZIEN_JUTRZEJSZY","ADRES_ZAMIESZKANIA","W_CHWILI_OBECNEJ","BYC_ZNAJDOWAC_SIE_W_POSIADANIU","DO_TERAZ","PROTOKOL_Z_CZEGO","PO_NAJMNIEJSZEJ_LINII","POTRAFIACY","zarowno_jak_rowniez","GRAC_FAIR_PLAY","DRUGI_NAJWIEKSZY","COFAC_SIE_DO_TYLU","DZIEN_WCZORAJSZY","NA_PRZESTRZENI","IDENTYCZNY_JAK","ZA_WYJATKIEM","MAPA_DROGOWA","W_PRZECIGU_TYGODNIA_W_CIGU","NAPOTKAC_NA","PRZERWA_KAWOWA","WYSOKA_FREKWENCJA","UBRAC_ZALOZYC","PRZY_UDZIALE","W_SLAD_ZA","WYRAZIC_POPARCIE","W_TYM_WZGLEDZIE","PO_PIERWSZE_PRIMO","DOMYSLEC_SIE","WARTY","IDENTYCZNY_DO","W_DRODZE_WYJATKU","PRZEDKLADAC_WNIOSEK","POD_RZAD","PRZYJAZNY_DLA_UZYTKOWNIKA","NA_WSKUTEK","SWIECIC_SUKCESY","W_WEGRZECH","KONDYCJA_FINANSOWA","RULE_NIEMNIEJ","FORMULA_KREMU","PODDAWAC_W_WATPLIWOSC","OPATRZEC_SIE","ODGRYWAC_ZNACZENIE","INFORMACJE_WRAZLIWE","DO_DZIS_DZIEN","CO_I_RAZ","OKRAGLY_ROK","SZERSZE_INFORMACJE","WYSOKA_FORMA","CZEKAC_ZA","BYNAJMNIEJ","WYWIERAC_PIETNO","DOPATRZEC_SIE","ZLA_RENOMA","W_PELNYM_TEGO","W_KAZDYM_BADZ","KOSZTOWAC_TANIEJ","DYGITALNY"],Ct.SPELLING_RULES_ID=["SPELLER_RULE","MORFOLOGIK_RULE","HUNSPELL","SPELLING_RULE","ORTHOGRAPHY"],Ct.STYLE_ISSUE_TYPES=["style","locale-violation","register"],Ct.EMAIL_SIGNATURE_SEPARATOR_REGEXP=/^[\u2010|\-]{2,}|[\u2010|\-]{2,}$/,Ct.ONLY_NUMBERS_REGEXP=/^[0-9]+$/,Ct.COLON_WHITESPACE_REGEXP=/^[;:]\s/,Ct.ONE_LETTER_AT_END_REGEXP=/(\s|^|\()[a-z]\.?\s?$/i,Ct.NUMBER_WITH_DOT_AT_END_REGEXP=/\d\.?\s?$/,Ct.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP=/\d\.?\)\s$/,Ct.PUNCTUATION_AT_END=/(\.|\!)$/,Ct.BULLET_POINT_REGEXP=/(\u25b6\ufe0e|\u25BA|\*|-|\u2013|\u2606|\u2605|\u25cf|\u2022|\u25e6|\u27A4|\u2714)\s+$/,Ct.LOWERCASE_REGEXP=/[a-z]/,Ct.DOT_WITH_PREFIX_REGEXP=/\w\.$/,Ct.SLASH_AT_END_REGEXP=/(\/|\\)$/,Ct.AT_LEAST_TWO_LETTERS_AT_END_REGEXP=/[a-z]{2}$/i,Ct.SLASH_AT_BEGINNING_REGEXP=/^(\/|\\)/,Ct.PUNCTUATION_AT_BEGINNING_REGEXP=/^\s?[\.\!\?,:\u2026]/,Ct.PUNCTUATION_SPACE_AT_END_REGEXP=/[\.\u2026\?\!]\s+/,Ct.MARKDOWN_HEADLINE_REGEXP=/^#{1,6}\s/m,Ct.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP=/^[\*\~\_\^\+\%\@]/m,Ct.WIKI_MARKUP_AT_END_REGEXP=/\[\[[a-z]+$/,Ct.PIPE_AT_END_REGEXP=/\|\s+$/,Ct.MENTION_SYMBOL_AT_BEGINNING_REGEXP=/@[a-z\.\-]*$/i,Ct.HASH_SYMBOL_AT_BEGINNING_REGEXP=/#[a-z\.\-]*$/i,Ct.EMOJI_SENTENCE_START_REGEXP=/(\.|!|\?|^)\s?(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])\s+/,Ct.ABBREVIATION_AT_END_REGEXP=/(\s|\(|^)[A-Z]\.$/,Ct.NET_AT_BEGINNING_REGEXP=/^net\b/i,Ct.SINGLE_UPPERCASE_LETTER_REGEXP=/^[A-Z]$/,Ct.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP=/^[^a-z0-9\xe4\xf6\xfc\xdf\xe1\xe0\xe2\xe9\xe8\xea\xed\xec\xee\xf3\xf2\xf4\xfa\xf9\xfb\.\?\!,\:\;\xbf\xa1]+/i,Ct.NON_ALPHANUMERIC_AT_END_REGEXP=/[^a-z0-9\xe4\xf6\xfc\xdf\xe1\xe0\xe2\xe9\xe8\xea\xed\xec\xee\xf3\xf2\xf4\xfa\xf9\xfb\.\?\!,\:\;\xbf\xa1]+$/i,Ct.HTML_ENTITIES=["amp","nbsp","gt","lt","bull","euro","copy","laquo","raquo","hellip","middot"],Ct.HTML_ENTITIES_WITH_AND=Ct.HTML_ENTITIES.map((e=>`&${e}`)),Ct.WAVY_DASH_REGEXP=/^\u3030+$/,Ct.INVISIBLE_PHRASE_REGEXP=/^[\u2063\uFEFF]+$/,Ct.INVISIBLE_CHARS_REGEXP=/[\u2063\uFEFF]/g,Ct.ZWNJ_REGEXP=/\u200B|\u200C/g,Ct.ZWS="\ufeff",Ct.PREVENT_MID_SENTENCE_CAPITALIZATION=/[\w\xe1\xe0\xe2\xf3\xf2\xec\xed\xe9\xe8\xf9\xfa\xe2\xf4\xee\xea\xfb\xe4\xf6\xfc\xdf,\)][\u0020\u00A0\uFEFF]*\n\n\n?[\u0020\u00A0\uFEFF"\u201e\xbb\xab\u201c\u2018]*$/,Ct.PREVENT_MID_SENTENCE_PUNCTUATION=/^[\u0020\u00A0\uFEFF]*\n\n\n?[a-z\xe1\xe0\xe2\xf3\xf2\xec\xed\xe9\xe8\xf9\xfa\xe2\xf4\xee\xea\xfb\xe4\xf6\xfc\xdf,\)]/,Ct.INVISIBLE_SEPARATOR_REGEX=new RegExp(We,"g"),Ct.COMMON_TLDS=["com","co","org","net","de","info","biz","es","fr","be","in","gov","nl","ca","com.br","br","at","us","au","ru","pl","ly","it","cat","edu","jp","ko","cn","se","no","mil","ch","dk","com.mx","mx","eu","co.uk","uk","ir","cz","ua","kr","gr","tw","nz","co.nz","za","ro","vn","io","tr","me","fi","tv","xyz","pt","ie","app"],Ct.COMMON_TLD_WITH_DOT_REGEXPS=Ct.COMMON_TLDS.map((e=>new RegExp(`^\\.${e.replace(".","\\.")}\\b`,"i"))),Ct.COMMON_FILE_TYPES=["jpeg","jpg","gif","png","bmp","indd","stl","svg","ai","sketch","ico","ics","env","amf","ps","psd","tiff","tif","mp3","wav","midi","mid","aif","mpa","ogg","wma","wpl","cda","7z","arj","deb","pkg","plist","rar","rpm","tar.gz","tar","zip","bin","dmg","iso","toast","vcd","csv","dat","db","log","mdb","sav","sql","xml","apk","bat","bin","cgi","com","exe","gadget","jar","py","js","jsx","json","wsf","ts","tsx","fnt","fon","otf","ttf","woff","woff2","rb","java","php","html","asp","aspx","cer","cfm","cgi","pl","css","scss","htm","jsp","part","rss","xhtml","key","odp","pps","ppt","pptx","class","cpp","cs","h","sh","swift","vb","ods","odt","xlr","xls","xlsx","xlt","xltx","bak","cab","cfg","cpl","cur","dll","dmp","msi","ini","tmp","3g2","3gp","avi","flv","h264","m4v","mkv","mov","mp4","mpg","mpeg","rm","swf","vob","wmv","doc","docx","dot","dotx","pdf","rtf","srx","text","tex","wks","wps","wpd","txt","yaml","yml","csl","md","adm"],Ct.COMMON_FILE_TYPE_WITH_DOT_REGEXPS=Ct.COMMON_FILE_TYPES.map((e=>new RegExp(`^[\\w\xe1\xe0\xe2\xf3\xf2\xec\xed\xe9\xe8\xf9\xfa\xe2\xf4\xee\xea\xfb\xe4\xf6\xfc\xdf\\-\\.\\(\\)]*?\\.${e}\\b`,"i"))),Ct.FILE_TYPE_AT_BEGINNING_REGEXP=new RegExp(`(${Ct.COMMON_FILE_TYPES.join("|")})\b`,"i"),Ct.HIGH_LEVEL_GOALS=[{id:"professional",tags:["clarity","confident","formal","general","positive","professional"]},{id:"scientific",tags:["academic","clarity","formal","general","objective","povrem","scientific"]},{id:"persuasive",tags:["clarity","confident","general","persuasive","positive"]},{id:"personal",tags:["clarity","general","informal","positive","povadd"]},{id:"creative",tags:["clarity","general"]}],Ct._textLevelAbortControllers=new Map,Ct._paragraphLevelAbortControllers=new Map,Ct._languageDetectionAbortControllers=new Map,Ct._recommendationAbortControllers=new Map,Ct._useFallbackServerForTextLevelRequests=!1,Ct._useFallbackServerForParagraphLevelRequests=!1,Ct._useFallbackServerForLanguageDetection=!1,Ct._mainServerUnavailabilityTimeStamp=0,Ct._checkForException=e=>e.ok?e:e.text().catch((()=>"")).then((t=>{const r=t.toLowerCase();if(r.includes("too many error"))throw{reason:"TooManyErrors",status:e.status,response:t};if(413===e.status||r.includes("text exceeds the limit"))throw{reason:"TextTooLong",status:e.status,response:t};if(t.toLowerCase().includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};if(429===e.status)throw{reason:"TooManyRequests",status:e.status,response:t};if(403===e.status){if(r.includes("client request size limit")||r.includes("client request limit")||r.includes("ip request limit")||r.includes("ip request size limit"))throw{reason:"TooManyRequests",status:e.status,response:t};if(r.includes("authexception"))throw{reason:"InvalidCredentials",status:e.status,response:t};throw{reason:"AccessDenied",status:e.status,response:t}}if(r.includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};throw{reason:"UnknownError",status:e.status,response:t}}));class Lt{static merge(e,t=!1,r=!1,s=!1){let{errors:n,pickyErrors:a,premiumErrors:i,premiumPickyErrors:o,sentenceRanges:E=[],recommendationErrors:l=[]}=this.filterAndMigrateErrors(e.existing.errors,e.existing.pickyErrors,e.existing.premiumErrors,e.existing.premiumPickyErrors,e.existing.recommendationErrors,e.existing.sentenceRanges,e.existingCheckedText,e.newCheckedText,e.existingRecommendationCheckedText,e.newRecommendationCheckedText,r,s);this.mergeParagraphLevelErrors(n,a,i,o,l,E,e.new.paragraphLevel.errors,e.new.paragraphLevel.pickyErrors,e.new.paragraphLevel.premiumErrors,e.new.paragraphLevel.premiumPickyErrors,e.new.paragraphLevel.recommendationErrors||[],e.new.paragraphLevel.sentenceRanges),this.mergeTextLevelErrors(n,a,i,o,e.new.textLevel.errors,e.new.textLevel.pickyErrors,e.new.textLevel.premiumErrors,e.new.textLevel.premiumPickyErrors);const _=this.getDuplicateErrors(e.existing,e.existingCheckedText,e.newCheckedText,e.existingRecommendationCheckedText,e.newRecommendationCheckedText);return this.sortErrors(n,a,i,o,l),this.setIdsOnErrors(n,a,i,o,l,_),n=this.migrateOffsetsToOriginalText(n,e.newCheckedText.usedParts),a=this.migrateOffsetsToOriginalText(a,e.newCheckedText.usedParts),i=this.migrateOffsetsToOriginalText(i,e.newCheckedText.usedParts),o=this.migrateOffsetsToOriginalText(o,e.newCheckedText.usedParts),l=this.migrateOffsetsToOriginalText(l,e.newRecommendationCheckedText.usedParts),E=this.migrateOffsetsToOriginalText(E,e.newCheckedText.usedParts),t&&(a=a.filter((e=>!me.includes(e.rule.id))),a.forEach((e=>{e.rule.id="HIDDEN_RULE",e.fixes=[]})),i=[...i,...o,...a],o=[],a=[],this.sortErrorsByOffset(i)),{errors:n,pickyErrors:a,premiumErrors:i,premiumPickyErrors:o,recommendationErrors:l,sentenceRanges:E}}static getDuplicateErrors(e,t,r,s,n){let{errors:a,pickyErrors:i,premiumErrors:o,premiumPickyErrors:E,recommendationErrors:l=[]}=e;a=this.migrateOffsetsToValuableText(a,t.usedParts),i=this.migrateOffsetsToValuableText(i,t.usedParts),o=this.migrateOffsetsToValuableText(o,t.usedParts),E=this.migrateOffsetsToValuableText(E,t.usedParts),l=this.migrateOffsetsToValuableText(l,s.usedParts);const _=dt(t.text,r.text),u=dt(s.text,n.text),c=e=>{if(!e.isParagraphLevelCheck)return!0;const t=At(e.isRecommendation?u:_,(t=>{const r=t.oldOffset;if(null===t.oldText)return e.start>=r?1:-1;const s=t.oldOffset+t.oldText.length+1;return St(e.start,r,s,!0)}));return!(!t||!t.textDiff)||void 0};return a=a.filter(c),i=i.filter(c),o=o.filter(c),E=E.filter(c),l=l.filter(c),a=this.migrateOffsetsBetweenTexts(a,_),i=this.migrateOffsetsBetweenTexts(i,_),o=this.migrateOffsetsBetweenTexts(o,_),E=this.migrateOffsetsBetweenTexts(E,_),l=this.migrateOffsetsBetweenTexts(l,u),{errors:a,pickyErrors:i,premiumErrors:o,premiumPickyErrors:E,recommendationErrors:l}}static migrateOffsetsToValuableText(e,t){const r=[];for(const s of e){const e=At(t,(e=>St(s.start,e.originalStart,e.originalEnd,!0))),n=At(t,(e=>St(s.end,e.originalStart,e.originalEnd)));if(!e||!n)continue;const a=Tt(s);a.start-=e.posDiff,a.end-=n.posDiff,a.length=a.end-a.start,r.push(a)}return r}static migrateOffsetsBetweenTexts(e,t,r,s,n){let a,i=!1,o=!1;"string"==typeof t&&"string"==typeof r?(a=dt(t,r),i="boolean"==typeof s&&s,o="boolean"==typeof n&&n):(a=t,i="boolean"==typeof r&&r,o="boolean"==typeof s&&s);const E=[];for(const t of e){const e=At(a,(e=>{const r=e.oldOffset;if(null===e.oldText)return t.start>=r?1:-1;const s=e.oldOffset+e.oldText.length+1;return St(t.start,r,s,!0)})),r=Tt(t);if(e){var l,_;if(e.textDiff){if(i)continue;{const t=e.oldOffset+e.textDiff.from,s=t+e.textDiff.oldFragment.length,n=!o;if(Nt(t,s,r.start,r.end,n))continue;if(r.start>=s){var u,c;const t=e.textDiff.newFragment.length-e.textDiff.oldFragment.length;r.start+=t,r.end+=t,null==r||null===(c=r.rule)||void 0===c||null===(u=c.phraseDiff)||void 0===u||u.forEach((e=>{e.sourceStart+=t,e.sourceEnd+=t,e.targetEnd+=t,e.targetStart+=t}))}}}r.start+=e.newOffset-e.oldOffset,r.end=r.start+r.length,null==r||null===(_=r.rule)||void 0===_||null===(l=_.phraseDiff)||void 0===l||l.forEach((t=>{const r=t.sourceEnd-t.sourceStart,s=t.targetEnd-t.targetStart;t.sourceStart+=e.newOffset-e.oldOffset,t.sourceEnd=t.sourceStart+r,t.targetStart+=e.newOffset-e.oldOffset,t.targetEnd=t.targetStart+s}))}E.push(r)}return E}static migrateOffsetsToOriginalText(e,t){const r=[];for(const s of e){const e=At(t,(e=>St(s.start,e.start,e.end,!0))),n=At(t,(e=>St(s.end,e.start,e.end)));if(!e||!n)continue;const a=Tt(s);a.start+=e.posDiff,a.end+=n.posDiff,a.length=a.end-a.start,r.push(a)}return r}static filterAndMigrateErrors(e,t,r,s,n,a,i,o,E,l,_=!1,u=!1){u?n=(n||[]).filter((e=>e.isParagraphLevelCheck)):(e=e.filter((e=>e.isParagraphLevelCheck)),t=t.filter((e=>e.isParagraphLevelCheck)),r=r.filter((e=>e.isParagraphLevelCheck)),s=s.filter((e=>e.isParagraphLevelCheck))),e=this.migrateOffsetsToValuableText(e,i.usedParts),t=this.migrateOffsetsToValuableText(t,i.usedParts),r=this.migrateOffsetsToValuableText(r,i.usedParts),s=this.migrateOffsetsToValuableText(s,i.usedParts),n=this.migrateOffsetsToValuableText(n||[],E.usedParts),a=this.migrateOffsetsToValuableText(a||[],i.usedParts);const c=dt(i.text,o.text),g=dt(E.text,l.text);return _?(e=this.migrateOffsetsBetweenTexts(e,i.text,o.text,!1,!0),t=this.migrateOffsetsBetweenTexts(t,i.text,o.text),r=this.migrateOffsetsBetweenTexts(r,i.text,o.text),s=this.migrateOffsetsBetweenTexts(s,i.text,o.text),n=this.migrateOffsetsBetweenTexts(n,E.text,l.text,!1,!0)):(e=this.migrateOffsetsBetweenTexts(e,c,!0),t=this.migrateOffsetsBetweenTexts(t,c,!0),r=this.migrateOffsetsBetweenTexts(r,c,!0),s=this.migrateOffsetsBetweenTexts(s,c,!0),n=this.migrateOffsetsBetweenTexts(n,g,!1,!0)),{errors:e,pickyErrors:t,premiumErrors:r,premiumPickyErrors:s,recommendationErrors:n,sentenceRanges:a=this.migrateOffsetsBetweenTexts(a,c,!0)}}static mergeParagraphLevelErrors(e,t,r,s,n,a,i,o,E,l,_,u=[]){e.push(...i),t.push(...o),r.push(...E),s.push(...l),n.push(..._),a.push(...u)}static mergeTextLevelErrors(e,t,r,s,n,a,i,o){for(const t of n)e.some((e=>e.start===t.start&&e.end===t.end))||e.push(t);for(const e of a)t.some((t=>t.start===e.start&&t.end===e.end))||t.push(e);for(const e of i)r.some((t=>t.start===e.start&&t.end===e.end))||r.push(e);for(const e of o)s.some((t=>t.start===e.start&&t.end===e.end))||s.push(e)}static sortErrors(e,t,r,s,n){this.sortErrorsByOffset(e),this.sortErrorsByOffset(t),this.sortErrorsByOffset(r),this.sortErrorsByOffset(s),this.sortErrorsByOffset(n)}static sortErrorsByOffset(e){e.sort(((e,t)=>e.start===t.start?e.isParagraphLevelCheck?1:-1:e.start>t.start?1:-1))}static migrateErrorsBetweenSameOriginalTexts(e,t,r){const s=[];for(const n of e){let e=n.start,a=n.end,i=At(t.usedParts,(t=>St(e,t.originalStart,t.originalEnd,!0))),o=At(t.usedParts,(e=>St(a,e.originalStart,e.originalEnd)));if(!i||!o)continue;if(e-=i.posDiff,a-=o.posDiff,i=At(r.usedParts,(t=>St(e,t.start,t.end,!0))),o=At(r.usedParts,(e=>St(a,e.start,e.end))),!i||!o)continue;e+=i.posDiff,a+=o.posDiff;const E=Tt(n);E.start=e,E.end=a,E.length=a-e,s.push(E)}return s}static setIdsOnErrors(e,t,r,s,n,a){function i(e,t){if(e.id)return;const r=t.find((t=>{return s=e,(r=t).start===s.start&&r.end===s.end&&r.isParagraphLevelCheck===s.isParagraphLevelCheck;var r,s}));e.id=r?r.id:"error:"+ ++Lt.INCREMENTAL_ID}e.forEach((e=>i(e,a.errors))),t.forEach((e=>i(e,a.pickyErrors))),r.forEach((e=>i(e,a.premiumErrors))),s.forEach((e=>i(e,a.premiumPickyErrors))),n.forEach((e=>i(e,a.recommendationErrors||[])))}static sortSentenceRanges(e){e.sort((({start:e},{start:t})=>e-t))}}Lt.INCREMENTAL_ID=0;const Pt={accept:"application/json","content-type":"application/json"};let Dt="claudia";function Mt(e){return et(e)&&!1===Object.values(e).some((e=>"number"!=typeof e))}function vt(e){return!!et(e)&&[["text"],["score",Mt],["label"],["origin"],["uuid"]].reduce(((t,[r,s=tt])=>{return!(!t||(n=s,"function"!=typeof n)||!(String(r)in e))&&s(e[String(r)]);var n}),!0)}async function Ut(){const e=function(){const e="object".indexOf("o")>-1;return Dt=e?Ne:Dt,("__"+Dt+"::"+~~(+new Date/1e3)).substring(2,64)}();return await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(e)}class Gt{static async load(e,t,r,s,n,a){const i=[a,t.trim()].join("@"),o=this._rewriteCache.get(i);var E;const l=null!==(E=this._history.get(t))&&void 0!==E?E:null;if(o)return Promise.resolve({rephrases:o,previousSentence:l});let _="/rewriting/rewrite";a&&(_+="/"+function(e){switch(e){case"simple":return"simplicity";case"formal":return"formality";default:return e}}(a));const u=(await this._request("rewrite",_,e,t,r,s,n)).filter((e=>vt(e))).map((({text:e,score:t,label:r,origin:s,uuid:n})=>({text:e,score:t,label:r,origin:s,uuid:n}))).filter((({text:e},t,r)=>r.findIndex((({text:t})=>e===t))===t));return u.length>0&&this._rewriteCache.set(i,u),{rephrases:u,previousSentence:l}}static abort(e){const t=void 0===e?["rewrite"]:[e];for(const e of t){const t=this._abortControllers.get(e)||[];this._abortCurrentRequests(t),this._abortControllers.set(e,[])}}static async _request(e,t,r,s,n,a,i){this.abort(e);const o=JSON.stringify({text:s,offset:0,length:0,count:"rewrite"===e?5:1,userID:r,language:n.slice(0,2),inhouseOnly:a,email:null==i?void 0:i.email,token:null==i?void 0:i.token,p:null==i?void 0:i.isPremium}),E=new AbortController,l=this._abortControllers.get(e)||[];Pt["X-LT-checksum"]=await Ut(),(null==i?void 0:i.isPremium)&&(Pt["X-LT-p"]="1"),l.push(E),this._abortControllers.set(e,l);const _=await fetch(O+t,{method:"post",signal:E.signal,mode:"cors",headers:Pt,body:o});if(!1===_.ok){const e=(()=>{switch(_.status){case 413:return"PayloadTooLarge";case 524:return"ServerTimeout";default:return`ServerFailure (${_.status})`}})();throw new Error(e)}const u=await _.json(),{rewrites:c=[]}=u||{};return c}static async requestSplitSentence(e,t,r,s,n){const a=this._splitSentenceCache.get(t.trim());if(a)return Promise.resolve(a);const[i]=await this._request("sentence-splitting","/rewriting/rewrite/sentence_splitting",e,t,r,s,n);return vt(i)?(this._splitSentenceCache.set(t.trim(),i),i):null}static _abortCurrentRequests(e){for(const t of e)t.abort()}}Gt._rewriteCache=new Map,Gt._splitSentenceCache=new Map,Gt._history=new Map,Gt._abortControllers=new Map([["rewrite",[]],["sentence-splitting",[]]]);(()=>{const e={}})();class bt{static _contructor(){if(this._isInitialized)return;bt._isChromium=navigator.userAgent.includes("Chrome/")||navigator.userAgent.includes("Chromium/"),bt._isFirefox=navigator.userAgent.includes("Firefox/"),bt._isThunderbird=navigator.userAgent.includes("Thunderbird/"),bt._isOpera=navigator.userAgent.includes("OPR/"),bt._isEdge=navigator.userAgent.includes("Edg/"),bt._isOldEdge=navigator.userAgent.includes("Edge/"),bt._isSafari=(navigator.userAgent.includes("Safari/")||navigator.userAgent.includes("AppleWebKit"))&&!bt._isChromium&&!bt._isEdge&&!bt._isOpera,bt._isYaBrowser=navigator.userAgent.includes("YaBrowser/"),bt._isChrome=bt._isChromium&&!bt._isOpera&&!bt._isEdge&&!bt._isOldEdge&&!bt._isYaBrowser;const e=navigator.userAgent.match(/Chrome\/(\d+)/);e&&(bt._isUnsupportedChrome=parseInt(e[1])<67&&!navigator.userAgent.includes("Edge/"));const t=navigator.userAgent.match(/Firefox\/(\d+)/);t&&(bt._isUnsupportedFirefox=parseInt(t[1])<60),this._isInitialized=!0}static getOS(){return navigator.userAgent.includes("Macintosh")?"Mac":navigator.userAgent.includes("Windows")?"Windows":navigator.userAgent.includes("CrOS")?"CrOS":navigator.userAgent.includes("Linux")?"Linux":"Other"}static isChromium(){return bt._isChromium}static isChrome(){return bt._isChrome}static isThunderbird(){return bt._isThunderbird}static isFirefox(){return bt._isFirefox}static isOpera(){return bt._isOpera}static isEdge(){return bt._isEdge}static isSafari(){return bt._isSafari}static isYaBrowser(){return bt._isYaBrowser}static isUnsupportedChrome(){return bt._isUnsupportedChrome}static isUnsupportedFirefox(){return bt._isUnsupportedFirefox}static isUnsupportedBrowser(){return bt.isUnsupportedChrome()||bt.isUnsupportedFirefox()}static getBrowserName(){return bt.isChrome()?"Chrome":bt.isFirefox()?"Firefox":bt.isOpera()?"Opera":bt.isEdge()?"Edge":bt.isSafari()?"Safari":bt.isYaBrowser()?"Yandex":"Unknown Browser"}static getUserAgentIdentifier(){let e="webextension";return this.isChrome()?e+="-chrome":this.isFirefox()?e+="-firefox":this.isOpera()?e+="-opera":this.isEdge()?e+="-edge":this.isYaBrowser()?e+="-chrome":this.isSafari()?e+="-safari":e+="-unknown",e+"-ng"}static isTouchDevice(){if(!("ontouchstart"in self))return!1;const e=navigator.userAgent.includes("Android");return this.isIOS()||e}static isIOS(){const e=navigator.userAgent.includes("iPhone OS"),t=navigator.userAgent.includes("Macintosh")&&Boolean(navigator.maxTouchPoints&&navigator.maxTouchPoints>2);return e||t}static isIOSTouchDevice(){return"ontouchstart"in self&&this.isIOS()}static isMacApp(){return navigator.userAgent.includes("AppleWebKit/")&&navigator.userAgent.includes("LanguageTool/")&&!navigator.userAgent.includes("Chrome/")&&!navigator.userAgent.includes("Chromium/")}static isWindowsApp(){return navigator.userAgent.includes("LanguageToolWindows/")}}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=Array(t);r<t;r++)s[r]=e[r];return s}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var s,n,a,i,o=[],E=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;E=!1}else for(;!(E=(s=a.call(r)).done)&&(o.push(s.value),o.length!==t);E=!0);}catch(e){l=!0,n=e}finally{try{if(!E&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ft(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var s=0,n=function(){};return{s:n,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=Array(t);r<t;r++)s[r]=e[r];return s}bt._isChromium=!1,bt._isChrome=!1,bt._isFirefox=!1,bt._isThunderbird=!1,bt._isOpera=!1,bt._isOldEdge=!1,bt._isEdge=!1,bt._isSafari=!1,bt._isYaBrowser=!1,bt._isUnsupportedChrome=!1,bt._isUnsupportedFirefox=!1,bt._isInitialized=!1,bt._contructor(),a.set(e.CHROME_EXTENSION_ID,"oldceeleldhonbafppcapldpdifcinji"),a.set(e.EXTN_PREFIX,"qb"),document.documentElement.setAttribute("data-".concat(a.get(e.EXTN_PREFIX),"-ready"),"true");var wt=a.get(e.CHROME_EXTENSION_ID);try{self._docs_annotate_canvas_by_ext=wt;var kt=self.chrome;self.chrome=self.chrome||{},self.chrome.runtime=self.chrome.runtime||{};var Wt=self.chrome.runtime.sendMessage;self.chrome.runtime.sendMessage=function(e){if(e!==wt)return Wt.apply(this,arguments);kt||delete self.chrome}}catch(e){}var Bt="#dd0000",Xt="#4285f4",Yt="#fce8e6",Zt="#e8f0fe",Kt=/rgba\(31,\s*161,\s*93,\s*0\.|rgba\(255,\s*0,\s*122,\s*0\.|rgba\(0,\s*163,\s*187,\s*0\.|rgba\(119,\s*119,\s*119,\s*0\.|rgba\(19,\s*115,\s*51,\s*0\.|rgba\(184,\s*6,\s*114,\s*0\.|rgba\(147,\s*52,\s*230,\s*0\.|rgba\(163,\s*90,\s*0,\s*0\./i,Vt=document.querySelectorAll(".".concat(a.get(e.EXTN_PREFIX),"-gdocs-disabled"));function qt(){return(null==Vt?void 0:Vt.length)>0}var $t=!1,jt=[];function zt(e,t){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=function(){var r=new CustomEvent(t,{bubbles:!0,detail:s});e.dispatchEvent(r)},$t?r():jt.push(r)}document.addEventListener("".concat(a.get(e.EXTN_PREFIX),"-gdocs-init"),(function(){for(var e=0,t=jt;e<t.length;e++){(0,t[e])()}jt.length=0,$t=!0}));var Jt=new Map,Qt=new Map,er=CanvasRenderingContext2D.prototype.moveTo;CanvasRenderingContext2D.prototype.moveTo=function(e,t){return Jt.set(this,{x:e,y:t}),er.apply(this,arguments)};var tr=CanvasRenderingContext2D.prototype.lineTo;CanvasRenderingContext2D.prototype.lineTo=function(t,r){var s=this.strokeStyle.toString(),n=Jt.get(this);if(Jt.set(this,{x:t,y:r}),!([Xt,Bt].includes(s.toLowerCase())&&!qt())){if((null==n?void 0:n.y)===r&&Kt.test(s)&&!qt()){var i=Qt.get(this);i||(i=[],Qt.set(this,i));var o=this.getTransform(),E=o.a,l=(o.b,o.c,o.d),_=o.e,u=o.f,c=Math.min(n.x,t)*E+_,g=Math.max(n.x,t)*E+_,R=r*l+u-this.lineWidth/2,d=r*l+u+this.lineWidth/2;i.push({bottom:d,left:c,right:g,top:R}),this.canvas&&zt(this.canvas,"".concat(a.get(e.EXTN_PREFIX),"-strikethroughchange"),{strikethroughLines:i})}return tr.apply(this,arguments)}};var rr=CanvasRenderingContext2D.prototype.fillRect;CanvasRenderingContext2D.prototype.fillRect=function(e,t,r,s){var n=this.fillStyle.toString();if(!([Zt,Yt].includes(n.toLowerCase())&&!qt()))return rr.apply(this,arguments)};var sr=CanvasRenderingContext2D.prototype.clearRect;CanvasRenderingContext2D.prototype.clearRect=function(t,r,s,n){var i=Qt.get(this);if(i&&!qt()){var o=this.getTransform(),E=o.a,l=(o.b,o.c,o.d),_=t*E+o.e,u=r*l+o.f,c={bottom:u+n*l,left:_,right:_+s*E,top:u};i.length!==(i=i.filter((function(e){return r=c,!!((t=e).left>r.right||t.right<r.left||t.top>r.bottom||t.bottom<r.top);var t,r}))).length&&(Qt.set(this,i),zt(this.canvas,"".concat(a.get(e.EXTN_PREFIX),"-strikethroughchange"),{strikethroughLines:i}))}return sr.apply(this,arguments)};var nr=CanvasRenderingContext2D.prototype.stroke;CanvasRenderingContext2D.prototype.stroke=function(){if(arguments[0]){var e=this.strokeStyle.toString();if([Xt,Bt].includes(e.toLowerCase())&&!qt())return}return nr.apply(this,arguments)};var ar=null;function ir(){try{if(null===ar&&(ar=function(){var e=self.KX_kixApp;if(!e)return null;for(var t=[[e,["KX_kixApp"]]],r=new Set([e]),s=0,n=t;s<n.length;s++){var a,i=yt(n[s],2),o=i[0],E=i[1],l=Ht(Object.getOwnPropertyNames(o));try{for(l.s();!(a=l.n()).done;){var _=a.value;try{var u=o[_];if("string"==typeof u&&u.startsWith("\x03"))return E.concat(_);!(!(E.length<20&&u instanceof Object)||u instanceof Node||u instanceof Window||u instanceof RegExp||u instanceof Date||u instanceof Map||Array.isArray(u)||r.has(u))&&(r.add(u),t.push([u,E.concat(_)]))}catch(e){}}}catch(e){l.e(e)}finally{l.f()}}return null}()),null===ar)return"";var e,t=self,r=Ht(ar);try{for(r.s();!(e=r.n()).done;){t=t[e.value]}}catch(e){r.e(e)}finally{r.f()}if("string"==typeof t)return t}catch(e){}return""}document.addEventListener("LanguageTool-getFullText",(function(e){try{var t,r=null===(t=e.detail)||void 0===t?void 0:t.datasetPropName;r&&(document.body.dataset[r]=ir())}catch(e){}}))})();
//# sourceMappingURL=sourceMap/content.js.map